Index: .idea/copilotDiffState.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project version=\"4\">\n  <component name=\"CopilotDiffPersistence\">\n    <option name=\"pendingDiffs\">\n      <map>\n        <entry key=\"$PROJECT_DIR$/backend/dunzomanagement/project_app/views.py\">\n          <value>\n            <PendingDiffInfo>\n              <option name=\"filePath\" value=\"$PROJECT_DIR$/backend/dunzomanagement/project_app/views.py\" />\n              <option name=\"originalContent\" value=\"import json&#10;from django.contrib.auth.decorators import login_required&#10;from django.db import connection&#10;from django.http import JsonResponse&#10;from django.utils.decorators import method_decorator&#10;from django.views.decorators.csrf import csrf_exempt&#10;from django.views import View&#10;from django.apps import apps&#10;&#10;from .models import *&#10;User = apps.get_model(app_label='user_app', model_name='User')&#10;Task = apps.get_model(app_label='task_app', model_name='Task')&#10;&#10;def decode_body(request):&#10;    try:&#10;        return json.loads(request.body.decode('utf-8'))&#10;    except json.JSONDecodeError:&#10;        return {}&#10;&#10;@method_decorator(csrf_exempt, name='dispatch')&#10;class ProjectView(View):&#10;    def dispatch(self, request, *args, **kwargs):&#10;        if not request.user.is_authenticated:&#10;            return JsonResponse({'success': False, 'error': 'Unauthorized'}, status=401)&#10;        return super().dispatch(request, *args, **kwargs)&#10;    def get(self, request):&#10;        user_id = request.user.pk&#10;&#10;        filter_type = request.GET.get('filter', 'Active')&#10;&#10;        # Validate filter to prevent SQL issues (optional but good practice)&#10;        valid_filters = ['Active', 'Archived', 'Complete', 'All', 'Leader']&#10;        if filter_type not in valid_filters:&#10;            filter_type = 'Active'&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Call the Stored Procedure&#10;                cursor.callproc(&quot;get_user_projects&quot;, [user_id, filter_type])&#10;&#10;                # Fetch the JSON result&#10;                projects_data = cursor.fetchone()[0]&#10;&#10;                return JsonResponse({'success': True, 'projects': projects_data})&#10;&#10;        except Exception as e:&#10;            print(f&quot;Get Projects Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': 'Internal Server Error'}, status=500)&#10;    def post(self, request):&#10;        data = decode_body(request)&#10;&#10;        # Extract data from the request body&#10;        user_id = request.user.pk&#10;        title = data.get('title')&#10;        description = data.get('description', '')  # Default to empty string if missing&#10;        start_date = data.get('start_date')&#10;        end_date = data.get('end_date')&#10;&#10;        # Basic Validation&#10;        if not title or not start_date or not end_date:&#10;            return JsonResponse({&#10;                'success': False,&#10;                'error': 'Title, Start Date, and End Date are required.'&#10;            }, status=400)&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Signature: (p_user_id, p_title, p_description, p_start_date, p_end_date)&#10;                cursor.callproc(&#10;                    &quot;create_project&quot;,&#10;                    [user_id, title, description, start_date, end_date]&#10;                )&#10;&#10;                # Fetch the returned Project ID&#10;                new_project_id = cursor.fetchone()[0]&#10;&#10;                return JsonResponse({&#10;                    'success': True,&#10;                    'message': 'Project created successfully',&#10;                    'project_id': new_project_id&#10;                }, status=201)&#10;&#10;        except Exception as e:&#10;            # Log error for debugging (optional)&#10;            print(f&quot;Create Project Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': str(e)}, status=500)&#10;    def delete(self, request):&#10;        user_id = request.user.pk&#10;&#10;        data = decode_body(request)&#10;        project_id = data.get('project_id')&#10;&#10;        if not project_id:&#10;            return JsonResponse({'success': False, 'error': 'Project ID is required'}, status=400)&#10;&#10;        try:&#10;            # 1. Security Check: Only the 'Leader' can delete&#10;            # We check if a membership exists that matches: User + Project + Role='Leader'&#10;            is_leader = ProjectMembership.objects.filter(&#10;                project_id=project_id,&#10;                user_id=user_id,&#10;                role='Leader'&#10;            ).exists()&#10;&#10;            if not is_leader:&#10;                return JsonResponse({&#10;                    'success': False,&#10;                    'error': 'Permission denied. Only the Leader can delete this project.'&#10;                }, status=403)&#10;&#10;            # 2. Perform Delete&#10;            Project.objects.get(pk=project_id).delete()&#10;&#10;            return JsonResponse({'success': True, 'message': 'Project deleted successfully'})&#10;&#10;        except Project.DoesNotExist:&#10;            return JsonResponse({'success': False, 'error': 'Project not found'}, status=404)&#10;        except Exception as e:&#10;            return JsonResponse({'success': False, 'error': str(e)}, status=500)&#10;&#10;@method_decorator(csrf_exempt, name='dispatch')&#10;class ProjectDetailView(View):&#10;    def dispatch(self, request, *args, **kwargs):&#10;        if not request.user.is_authenticated:&#10;            return JsonResponse({'success': False, 'error': 'Unauthorized'}, status=401)&#10;        return super().dispatch(request, *args, **kwargs)&#10;    # get project details&#10;    def get(self, request):&#10;        project_id = request.GET.get('project_id')&#10;        user_id = request.user.pk&#10;&#10;        if not project_id:&#10;            return JsonResponse({'success': False, 'error': 'Project ID is required.'}, status=400)&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Call Stored Procedure&#10;                # Signature: (p_project_id, p_user_id)&#10;                cursor.callproc(&#10;                    &quot;get_project_details&quot;,&#10;                    [project_id, user_id]&#10;                )&#10;&#10;                # Fetch the single JSON blob result&#10;                result = cursor.fetchone()[0]&#10;&#10;                # Check status code based on result success&#10;                if result.get('success'):&#10;                    return JsonResponse(result)&#10;                else:&#10;                    # Determine error code (403 for Unauthorized, 404 for Not Found)&#10;                    error_msg = result.get('error', '')&#10;                    status_code = 403 if 'Unauthorized' in error_msg else 404&#10;                    return JsonResponse(result, status=status_code)&#10;&#10;        except Exception as e:&#10;            print(f&quot;Get Project Details Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': 'Internal Server Error'}, status=500)&#10;    # update project details&#10;    def put(self, request):&#10;        data = decode_body(request)&#10;        user_id = request.user.pk&#10;&#10;        project_id = data.get('project_id')&#10;        title = data.get('title')&#10;        description = data.get('description', '')&#10;        start_date = data.get('start_date')&#10;        end_date = data.get('end_date')&#10;        status = data.get('status')&#10;&#10;        # Basic Validation&#10;        if not project_id or not title or not start_date or not end_date:&#10;            return JsonResponse({&#10;                'success': False,&#10;                'error': 'Project ID, Title, and Dates are required.'&#10;            }, status=400)&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Signature: (p_project_id, p_user_id, p_title, p_description, p_start_date, p_end_date,status)&#10;                cursor.callproc(&#10;                    &quot;update_project&quot;,&#10;                    [project_id, user_id, title, description, start_date, end_date, status]&#10;                )&#10;&#10;                # The procedure returns True (Success) or False (Not Leader/Failed)&#10;                success = cursor.fetchone()[0]&#10;&#10;                if success:&#10;                    return JsonResponse({'success': True, 'message': 'Project updated successfully'})&#10;                else:&#10;                    return JsonResponse({&#10;                        'success': False,&#10;                        'error': 'Permission denied. Only the Leader can edit this project.'&#10;                    }, status=403)&#10;&#10;        except Exception as e:&#10;            print(f&quot;Update Project Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': str(e)}, status=500)&#10;&#10;@method_decorator(csrf_exempt, name='dispatch')&#10;class ProjectMembershipView(View):&#10;    def dispatch(self, request, *args, **kwargs):&#10;        if not request.user.is_authenticated:&#10;            return JsonResponse({'success': False, 'error': 'Unauthorized'}, status=401)&#10;        return super().dispatch(request, *args, **kwargs)&#10;    # add a user to project&#10;    def post(self, request):&#10;        data = decode_body(request)&#10;        requester_id = request.user.pk&#10;&#10;        # Parse inputs&#10;        project_id = data.get('project_id')&#10;        identifier = data.get('identifier')&#10;        role = data.get('role', 'Member')  # Default to 'Member' if not provided&#10;&#10;        # Basic Validation&#10;        if not project_id or not identifier:&#10;            return JsonResponse({'success': False, 'error': 'Project ID and Username/Email are required.'}, status=400)&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Signature: (p_project_id, p_requester_id, p_identifier, p_role)&#10;                cursor.callproc(&#10;                    &quot;add_project_member&quot;,&#10;                    [project_id, requester_id, identifier, role]&#10;                )&#10;&#10;                result = cursor.fetchone()[0]&#10;&#10;                if result.get('success'):&#10;                    return JsonResponse(result, status=201)&#10;                else:&#10;                    # Return 400 or 403 depending on the error, but 400 is generally fine here&#10;                    return JsonResponse(result, status=400)&#10;&#10;        except Exception as e:&#10;            print(f&quot;Add Member Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': 'Internal Server Error'}, status=500)&#10;    # remove a user fron project&#10;    def delete(self, request):&#10;        data = decode_body(request)&#10;        requester_id = request.user.pk&#10;&#10;        project_id = data.get('project_id')&#10;        target_user_id = data.get('user_id')&#10;&#10;        # Basic Validation&#10;        if not project_id or not target_user_id:&#10;            return JsonResponse({'success': False, 'error': 'Project ID and Target User ID are required.'}, status=400)&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Signature: (p_project_id, p_requester_id, p_target_user_id)&#10;                cursor.callproc(&#10;                    &quot;remove_project_member&quot;,&#10;                    [project_id, requester_id, target_user_id]&#10;                )&#10;&#10;                # Fetch result&#10;                result = cursor.fetchone()[0]&#10;&#10;                if result.get('success'):&#10;                    return JsonResponse(result)&#10;                else:&#10;                    # Return 403 Forbidden if permission/safety check failed&#10;                    return JsonResponse(result, status=403)&#10;&#10;        except Exception as e:&#10;            print(f&quot;Remove Member Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': 'Internal Server Error'}, status=500)&#10;    # change user role in project&#10;    def put(self, request):&#10;        data = decode_body(request)&#10;        requester_id = request.user.pk  # The logged-in user (must be Leader)&#10;&#10;        # Parse inputs&#10;        project_id = data.get('project_id')&#10;        target_user_id = data.get('user_id')  # The user receiving the role change&#10;        new_role = data.get('role')&#10;&#10;        # Basic Validation&#10;        if not all([project_id, target_user_id, new_role]):&#10;            return JsonResponse({'success': False, 'error': 'Project ID, Target User ID, and Role are required.'},&#10;                                status=400)&#10;&#10;        valid_roles = ['Leader', 'Manager', 'Member']&#10;        if new_role not in valid_roles:&#10;            return JsonResponse({'success': False, 'error': 'Invalid role choice.'}, status=400)&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Call Stored Procedure&#10;                # Signature: (p_project_id, p_requester_id, p_target_user_id, p_new_role)&#10;                cursor.callproc(&#10;                    &quot;update_project_member_role&quot;,&#10;                    [project_id, requester_id, target_user_id, new_role]&#10;                )&#10;&#10;                # The SP returns a JSON object directly&#10;                result = cursor.fetchone()[0]&#10;&#10;                # Check the 'success' key from the returned JSON&#10;                if result.get('success'):&#10;                    return JsonResponse(result)&#10;                else:&#10;                    # Return 403 Forbidden if permission/safety check failed&#10;                    return JsonResponse(result, status=403)&#10;&#10;        except Exception as e:&#10;            print(f&quot;Update Role Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': 'Internal Server Error'}, status=500)&#10;&#10;@method_decorator(csrf_exempt, name='dispatch')&#10;class TagView(View):&#10;    def dispatch(self, request, *args, **kwargs):&#10;        if not request.user.is_authenticated:&#10;            return JsonResponse({'success': False, 'error': 'Unauthorized'}, status=401)&#10;        return super().dispatch(request, *args, **kwargs)&#10;    # create tag&#10;    def post(self, request):&#10;        data = decode_body(request)&#10;        project_id = data.get('project_id')&#10;        name = data.get('name')&#10;        hex_color = data.get('hex_color', '#000000')&#10;&#10;        if not project_id or not name:&#10;            return JsonResponse({'success': False, 'error': 'Project ID and Name are required.'}, status=400)&#10;&#10;        try:&#10;            # PERMISSION CHECK: Must be Leader or Manager&#10;            has_permission = ProjectMembership.objects.filter(&#10;                project_id=project_id,&#10;                user_id=request.user.pk,&#10;                role__in=['Leader', 'Manager']  # &lt;--- Strict Check&#10;            ).exists()&#10;&#10;            if not has_permission:&#10;                return JsonResponse({'success': False, 'error': 'Only Leaders or Managers can create tags.'},&#10;                                    status=403)&#10;&#10;            # Create&#10;            tag = Tag.objects.create(&#10;                project_id=project_id,&#10;                name=name,&#10;                hex_color=hex_color&#10;            )&#10;&#10;            return JsonResponse({&#10;                'success': True,&#10;                'tag': {'tag_id': tag.tag_id, 'name': tag.name, 'hex_color': tag.hex_color}&#10;            }, status=201)&#10;&#10;        except Exception as e:&#10;            return JsonResponse({'success': False, 'error': str(e)}, status=500)&#10;    # edit tag&#10;    def put(self, request):&#10;        data = decode_body(request)&#10;        tag_id = data.get('tag_id')&#10;        name = data.get('name')&#10;        hex_color = data.get('hex_color')&#10;&#10;        if not tag_id:&#10;            return JsonResponse({'success': False, 'error': 'Tag ID is required.'}, status=400)&#10;&#10;        try:&#10;            tag = Tag.objects.get(pk=tag_id)&#10;&#10;            # PERMISSION CHECK&#10;            has_permission = ProjectMembership.objects.filter(&#10;                project_id=tag.project_id,&#10;                user_id=request.user.pk,&#10;                role__in=['Leader', 'Manager']&#10;            ).exists()&#10;&#10;            if not has_permission:&#10;                return JsonResponse({'success': False, 'error': 'Only Leaders or Managers can edit tags.'}, status=403)&#10;&#10;            if name:&#10;                tag.name = name&#10;            if hex_color:&#10;                tag.hex_color = hex_color&#10;&#10;            tag.save()&#10;&#10;            return JsonResponse({'success': True, 'message': 'Tag updated successfully.'})&#10;&#10;        except Tag.DoesNotExist:&#10;            return JsonResponse({'success': False, 'error': 'Tag not found.'}, status=404)&#10;        except Exception as e:&#10;            return JsonResponse({'success': False, 'error': str(e)}, status=500)&#10;    # delete tag&#10;    def delete(self, request):&#10;        data = decode_body(request)&#10;        tag_id = data.get('tag_id')&#10;&#10;        if not tag_id:&#10;            return JsonResponse({'success': False, 'error': 'Tag ID is required.'}, status=400)&#10;&#10;        try:&#10;            tag = Tag.objects.get(pk=tag_id)&#10;&#10;            # PERMISSION CHECK&#10;            has_permission = ProjectMembership.objects.filter(&#10;                project_id=tag.project_id,&#10;                user_id=request.user.pk,&#10;                role__in=['Leader', 'Manager']&#10;            ).exists()&#10;&#10;            if not has_permission:&#10;                return JsonResponse({'success': False, 'error': 'Only Leaders or Managers can delete tags.'}, status=403)&#10;&#10;            tag.delete()&#10;&#10;            return JsonResponse({'success': True, 'message': 'Tag deleted successfully.'})&#10;&#10;        except Tag.DoesNotExist:&#10;            return JsonResponse({'success': False, 'error': 'Tag not found.'}, status=404)&#10;        except Exception as e:&#10;            return JsonResponse({'success': False, 'error': str(e)}, status=500)&#10;\" />\n              <option name=\"updatedContent\" value=\"import json&#10;from django.contrib.auth.decorators import login_required&#10;from django.db import connection&#10;from django.http import JsonResponse&#10;from django.utils.decorators import method_decorator&#10;from django.views.decorators.csrf import csrf_exempt&#10;from django.views import View&#10;from django.apps import apps&#10;&#10;from .models import *&#10;User = apps.get_model(app_label='user_app', model_name='User')&#10;Task = apps.get_model(app_label='task_app', model_name='Task')&#10;&#10;def decode_body(request):&#10;    try:&#10;        return json.loads(request.body.decode('utf-8'))&#10;    except json.JSONDecodeError:&#10;        return {}&#10;&#10;@method_decorator(csrf_exempt, name='dispatch')&#10;class ProjectView(View):&#10;    def dispatch(self, request, *args, **kwargs):&#10;        if not request.user.is_authenticated:&#10;            return JsonResponse({'success': False, 'error': 'Unauthorized'}, status=401)&#10;        return super().dispatch(request, *args, **kwargs)&#10;    def get(self, request):&#10;        user_id = request.user.pk&#10;&#10;        filter_type = request.GET.get('filter', 'Active')&#10;&#10;        # Validate filter to prevent SQL issues (optional but good practice)&#10;        valid_filters = ['Active', 'Archived', 'Complete', 'All', 'Leader']&#10;        if filter_type not in valid_filters:&#10;            filter_type = 'Active'&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Call the Stored Procedure&#10;                cursor.callproc(&quot;get_user_projects&quot;, [user_id, filter_type])&#10;&#10;                # Fetch the JSON result&#10;                projects_data = cursor.fetchone()[0]&#10;&#10;                return JsonResponse({'success': True, 'projects': projects_data})&#10;&#10;        except Exception as e:&#10;            print(f&quot;Get Projects Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': 'Internal Server Error'}, status=500)&#10;    def post(self, request):&#10;        data = decode_body(request)&#10;&#10;        # Extract data from the request body&#10;        user_id = request.user.pk&#10;        title = data.get('title')&#10;        description = data.get('description', '')  # Default to empty string if missing&#10;        start_date = data.get('start_date')&#10;        end_date = data.get('end_date')&#10;&#10;        # Basic Validation&#10;        if not title or not start_date or not end_date:&#10;            return JsonResponse({&#10;                'success': False,&#10;                'error': 'Title, Start Date, and End Date are required.'&#10;            }, status=400)&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Signature: (p_user_id, p_title, p_description, p_start_date, p_end_date)&#10;                cursor.callproc(&#10;                    &quot;create_project&quot;,&#10;                    [user_id, title, description, start_date, end_date]&#10;                )&#10;&#10;                # Fetch the returned Project ID&#10;                new_project_id = cursor.fetchone()[0]&#10;&#10;                return JsonResponse({&#10;                    'success': True,&#10;                    'message': 'Project created successfully',&#10;                    'project_id': new_project_id&#10;                }, status=201)&#10;&#10;        except Exception as e:&#10;            # Log error for debugging (optional)&#10;            print(f&quot;Create Project Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': str(e)}, status=500)&#10;    def delete(self, request):&#10;        user_id = request.user.pk&#10;&#10;        data = decode_body(request)&#10;        project_id = data.get('project_id')&#10;&#10;        if not project_id:&#10;            return JsonResponse({'success': False, 'error': 'Project ID is required'}, status=400)&#10;&#10;        try:&#10;            # 1. Security Check: Only the 'Leader' can delete&#10;            # We check if a membership exists that matches: User + Project + Role='Leader'&#10;            is_leader = ProjectMembership.objects.filter(&#10;                project_id=project_id,&#10;                user_id=user_id,&#10;                role='Leader'&#10;            ).exists()&#10;&#10;            if not is_leader:&#10;                return JsonResponse({&#10;                    'success': False,&#10;                    'error': 'Permission denied. Only the Leader can delete this project.'&#10;                }, status=403)&#10;&#10;            # 2. Perform Delete&#10;            Project.objects.get(pk=project_id).delete()&#10;&#10;            return JsonResponse({'success': True, 'message': 'Project deleted successfully'})&#10;&#10;        except Project.DoesNotExist:&#10;            return JsonResponse({'success': False, 'error': 'Project not found'}, status=404)&#10;        except Exception as e:&#10;            return JsonResponse({'success': False, 'error': str(e)}, status=500)&#10;&#10;@method_decorator(csrf_exempt, name='dispatch')&#10;class ProjectDetailView(View):&#10;    def dispatch(self, request, *args, **kwargs):&#10;        if not request.user.is_authenticated:&#10;            return JsonResponse({'success': False, 'error': 'Unauthorized'}, status=401)&#10;        return super().dispatch(request, *args, **kwargs)&#10;    # get project details&#10;    def get(self, request):&#10;        project_id = request.GET.get('project_id')&#10;        user_id = request.user.pk&#10;&#10;        if not project_id:&#10;            return JsonResponse({'success': False, 'error': 'Project ID is required.'}, status=400)&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Call Stored Procedure&#10;                # Signature: (p_project_id, p_user_id)&#10;                cursor.callproc(&#10;                    &quot;get_project_details&quot;,&#10;                    [project_id, user_id]&#10;                )&#10;&#10;                # Fetch the single JSON blob result&#10;                result = cursor.fetchone()[0]&#10;&#10;                # Check status code based on result success&#10;                if result.get('success'):&#10;                    return JsonResponse(result)&#10;                else:&#10;                    # Determine error code (403 for Unauthorized, 404 for Not Found)&#10;                    error_msg = result.get('error', '')&#10;                    status_code = 403 if 'Unauthorized' in error_msg else 404&#10;                    return JsonResponse(result, status=status_code)&#10;&#10;        except Exception as e:&#10;            print(f&quot;Get Project Details Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': 'Internal Server Error'}, status=500)&#10;    # update project details&#10;    def put(self, request):&#10;        data = decode_body(request)&#10;        user_id = request.user.pk&#10;&#10;        project_id = data.get('project_id')&#10;        title = data.get('title')&#10;        description = data.get('description', '')&#10;        start_date = data.get('start_date')&#10;        end_date = data.get('end_date')&#10;        status = data.get('status')&#10;&#10;        # Basic Validation&#10;        if not project_id or not title or not start_date or not end_date:&#10;            return JsonResponse({&#10;                'success': False,&#10;                'error': 'Project ID, Title, and Dates are required.'&#10;            }, status=400)&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Signature: (p_project_id, p_user_id, p_title, p_description, p_start_date, p_end_date,status)&#10;                cursor.callproc(&#10;                    &quot;update_project&quot;,&#10;                    [project_id, user_id, title, description, start_date, end_date, status]&#10;                )&#10;&#10;                # The procedure returns True (Success) or False (Not Leader/Failed)&#10;                success = cursor.fetchone()[0]&#10;&#10;                if success:&#10;                    return JsonResponse({'success': True, 'message': 'Project updated successfully'})&#10;                else:&#10;                    return JsonResponse({&#10;                        'success': False,&#10;                        'error': 'Permission denied. Only the Leader can edit this project.'&#10;                    }, status=403)&#10;&#10;        except Exception as e:&#10;            print(f&quot;Update Project Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': str(e)}, status=500)&#10;&#10;@method_decorator(csrf_exempt, name='dispatch')&#10;class ProjectMembershipView(View):&#10;    def dispatch(self, request, *args, **kwargs):&#10;        if not request.user.is_authenticated:&#10;            return JsonResponse({'success': False, 'error': 'Unauthorized'}, status=401)&#10;        return super().dispatch(request, *args, **kwargs)&#10;    # add a user to project&#10;    def post(self, request):&#10;        data = decode_body(request)&#10;        requester_id = request.user.pk&#10;&#10;        # Parse inputs&#10;        project_id = data.get('project_id')&#10;        identifier = data.get('identifier')&#10;        role = data.get('role', 'Member')  # Default to 'Member' if not provided&#10;&#10;        # Basic Validation&#10;        if not project_id or not identifier:&#10;            return JsonResponse({'success': False, 'error': 'Project ID and Username/Email are required.'}, status=400)&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Signature: (p_project_id, p_requester_id, p_identifier, p_role)&#10;                cursor.callproc(&#10;                    &quot;add_project_member&quot;,&#10;                    [project_id, requester_id, identifier, role]&#10;                )&#10;&#10;                result = cursor.fetchone()[0]&#10;&#10;                if result.get('success'):&#10;                    return JsonResponse(result, status=201)&#10;                else:&#10;                    # Return 400 or 403 depending on the error, but 400 is generally fine here&#10;                    return JsonResponse(result, status=400)&#10;&#10;        except Exception as e:&#10;            print(f&quot;Add Member Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': 'Internal Server Error'}, status=500)&#10;    # remove a user fron project&#10;    def delete(self, request):&#10;        data = decode_body(request)&#10;        requester_id = request.user.pk&#10;&#10;        project_id = data.get('project_id')&#10;        target_user_id = data.get('user_id')&#10;&#10;        # Basic Validation&#10;        if not project_id or not target_user_id:&#10;            return JsonResponse({'success': False, 'error': 'Project ID and Target User ID are required.'}, status=400)&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Signature: (p_project_id, p_requester_id, p_target_user_id)&#10;                cursor.callproc(&#10;                    &quot;remove_project_member&quot;,&#10;                    [project_id, requester_id, target_user_id]&#10;                )&#10;&#10;                # Fetch result&#10;                result = cursor.fetchone()[0]&#10;&#10;                if result.get('success'):&#10;                    return JsonResponse(result)&#10;                else:&#10;                    # Return 403 Forbidden if permission/safety check failed&#10;                    return JsonResponse(result, status=403)&#10;&#10;        except Exception as e:&#10;            print(f&quot;Remove Member Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': 'Internal Server Error'}, status=500)&#10;    # change user role in project&#10;    def put(self, request):&#10;        data = decode_body(request)&#10;        requester_id = request.user.pk  # The logged-in user (must be Leader)&#10;&#10;        # Parse inputs&#10;        project_id = data.get('project_id')&#10;        target_user_id = data.get('user_id')  # The user receiving the role change&#10;        new_role = data.get('role')&#10;&#10;        # Basic Validation&#10;        if not all([project_id, target_user_id, new_role]):&#10;            return JsonResponse({'success': False, 'error': 'Project ID, Target User ID, and Role are required.'},&#10;                                status=400)&#10;&#10;        valid_roles = ['Leader', 'Manager', 'Member']&#10;        if new_role not in valid_roles:&#10;            return JsonResponse({'success': False, 'error': 'Invalid role choice.'}, status=400)&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Call Stored Procedure&#10;                # Signature: (p_project_id, p_requester_id, p_target_user_id, p_new_role)&#10;                cursor.callproc(&#10;                    &quot;update_project_member_role&quot;,&#10;                    [project_id, requester_id, target_user_id, new_role]&#10;                )&#10;&#10;                # The SP returns a JSON object directly&#10;                result = cursor.fetchone()[0]&#10;&#10;                # Check the 'success' key from the returned JSON&#10;                if result.get('success'):&#10;                    return JsonResponse(result)&#10;                else:&#10;                    # Return 403 Forbidden if permission/safety check failed&#10;                    return JsonResponse(result, status=403)&#10;&#10;        except Exception as e:&#10;            print(f&quot;Update Role Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': 'Internal Server Error'}, status=500)&#10;&#10;@method_decorator(csrf_exempt, name='dispatch')&#10;class TagView(View):&#10;    def dispatch(self, request, *args, **kwargs):&#10;        if not request.user.is_authenticated:&#10;            return JsonResponse({'success': False, 'error': 'Unauthorized'}, status=401)&#10;        return super().dispatch(request, *args, **kwargs)&#10;    # create tag&#10;    def post(self, request):&#10;        data = decode_body(request)&#10;        project_id = data.get('project_id')&#10;        name = data.get('name')&#10;        hex_color = data.get('hex_color', '#000000')&#10;&#10;        if not project_id or not name:&#10;            return JsonResponse({'success': False, 'error': 'Project ID and Name are required.'}, status=400)&#10;&#10;        try:&#10;            # PERMISSION CHECK: Must be Leader or Manager&#10;            has_permission = ProjectMembership.objects.filter(&#10;                project_id=project_id,&#10;                user_id=request.user.pk,&#10;                role__in=['Leader', 'Manager']  # &lt;--- Strict Check&#10;            ).exists()&#10;&#10;            if not has_permission:&#10;                return JsonResponse({'success': False, 'error': 'Only Leaders or Managers can create tags.'},&#10;                                    status=403)&#10;&#10;            # Create&#10;            tag = Tag.objects.create(&#10;                project_id=project_id,&#10;                name=name,&#10;                hex_color=hex_color&#10;            )&#10;&#10;            return JsonResponse({&#10;                'success': True,&#10;                'tag': {'tag_id': tag.tag_id, 'name': tag.name, 'hex_color': tag.hex_color}&#10;            }, status=201)&#10;&#10;        except Exception as e:&#10;            return JsonResponse({'success': False, 'error': str(e)}, status=500)&#10;    # edit tag&#10;    def put(self, request):&#10;        data = decode_body(request)&#10;        tag_id = data.get('tag_id')&#10;        name = data.get('name')&#10;        hex_color = data.get('hex_color')&#10;&#10;        if not tag_id:&#10;            return JsonResponse({'success': False, 'error': 'Tag ID is required.'}, status=400)&#10;&#10;        try:&#10;            tag = Tag.objects.get(pk=tag_id)&#10;&#10;            # PERMISSION CHECK&#10;            has_permission = ProjectMembership.objects.filter(&#10;                project_id=tag.project_id,&#10;                user_id=request.user.pk,&#10;                role__in=['Leader', 'Manager']&#10;            ).exists()&#10;&#10;            if not has_permission:&#10;                return JsonResponse({'success': False, 'error': 'Only Leaders or Managers can edit tags.'}, status=403)&#10;&#10;            if name:&#10;                tag.name = name&#10;            if hex_color:&#10;                tag.hex_color = hex_color&#10;&#10;            tag.save()&#10;&#10;            return JsonResponse({'success': True, 'message': 'Tag updated successfully.'})&#10;&#10;        except Tag.DoesNotExist:&#10;            return JsonResponse({'success': False, 'error': 'Tag not found.'}, status=404)&#10;        except Exception as e:&#10;            return JsonResponse({'success': False, 'error': str(e)}, status=500)&#10;    # delete tag&#10;    def delete(self, request):&#10;        data = decode_body(request)&#10;        tag_id = data.get('tag_id')&#10;&#10;        if not tag_id:&#10;            return JsonResponse({'success': False, 'error': 'Tag ID is required.'}, status=400)&#10;&#10;        try:&#10;            tag = Tag.objects.get(pk=tag_id)&#10;&#10;            # PERMISSION CHECK&#10;            has_permission = ProjectMembership.objects.filter(&#10;                project_id=tag.project_id,&#10;                user_id=request.user.pk,&#10;                role__in=['Leader', 'Manager']&#10;            ).exists()&#10;&#10;            if not has_permission:&#10;                return JsonResponse({'success': False, 'error': 'Only Leaders or Managers can delete tags.'}, status=403)&#10;&#10;            tag.delete()&#10;&#10;            return JsonResponse({'success': True, 'message': 'Tag deleted successfully.'})&#10;&#10;        except Tag.DoesNotExist:&#10;            return JsonResponse({'success': False, 'error': 'Tag not found.'}, status=404)&#10;        except Exception as e:&#10;            return JsonResponse({'success': False, 'error': str(e)}, status=500)\" />\n            </PendingDiffInfo>\n          </value>\n        </entry>\n        <entry key=\"$PROJECT_DIR$/backend/dunzomanagement/user_app/views.py\">\n          <value>\n            <PendingDiffInfo>\n              <option name=\"filePath\" value=\"$PROJECT_DIR$/backend/dunzomanagement/user_app/views.py\" />\n              <option name=\"originalContent\" value=\"import json&#10;from django.contrib.auth import logout&#10;from django.contrib.auth.decorators import login_required&#10;from django.db import connection&#10;from django.http import JsonResponse&#10;from django.shortcuts import get_object_or_404&#10;from django.utils.decorators import method_decorator&#10;from django.views.decorators.csrf import csrf_exempt&#10;from django.views import View&#10;from django.apps import apps&#10;&#10;from .models import Notification&#10;Task = apps.get_model(app_label='task_app', model_name='Task')&#10;Project = apps.get_model(app_label='project_app', model_name='Project')&#10;CalendarEvent = apps.get_model(app_label='calendarevent_app', model_name='CalendarEvent')&#10;&#10;&#10;def decode_body(request):&#10;    try:&#10;        return json.loads(request.body.decode('utf-8'))&#10;    except json.JSONDecodeError:&#10;        return {}&#10;&#10;@login_required&#10;def get_dashboard(request):&#10;    user_id = request.user.pk&#10;&#10;    try:&#10;        with connection.cursor() as cursor:&#10;            cursor.callproc(&quot;get_user_dashboard_data&quot;, [user_id])&#10;&#10;            # Fetch the result (returns a tuple, we want the first element)&#10;            row = cursor.fetchone()&#10;&#10;            if row and row[0]:&#10;                result = row[0]&#10;                return JsonResponse(result, safe=False)&#10;            else:&#10;                # Handle case where procedure returns NULL (shouldn't happen with this SQL)&#10;                return JsonResponse({'error': 'No data returned'}, status=500)&#10;&#10;    except Exception as e:&#10;        # Log the specific error for debugging&#10;        print(f&quot;Dashboard Stored Procedure Error: {e}&quot;)&#10;        return JsonResponse({'error': 'Internal Server Error'}, status=500)&#10;&#10;@method_decorator(csrf_exempt, name='dispatch')&#10;class UserView(View):&#10;    def dispatch(self, request, *args, **kwargs):&#10;        if not request.user.is_authenticated:&#10;            return JsonResponse({'success': False, 'error': 'Unauthorized'}, status=401)&#10;        return super().dispatch(request, *args, **kwargs)&#10;&#10;    # settings&#10;    def get(self, request):&#10;        user = request.user&#10;        user_data = {&#10;            &quot;user_id&quot;: user.pk,&#10;            &quot;username&quot;: user.username,&#10;            &quot;email&quot;: user.email,&#10;            &quot;first_name&quot;: user.first_name,&#10;            &quot;last_name&quot;: user.last_name,&#10;        }&#10;        return JsonResponse(user_data)&#10;    # edit user details&#10;    def put(self, request):&#10;        data = decode_body(request)&#10;        user = request.user&#10;&#10;        # Update fields if they are provided in the request&#10;        user.username = data.get('username', user.username)&#10;        user.email = data.get('email', user.email)&#10;        user.first_name = data.get('first_name', user.first_name)&#10;        user.last_name = data.get('last_name', user.last_name)&#10;&#10;        # If password is provided, update it (make sure to hash it)&#10;        new_password = data.get('password')&#10;        if new_password:&#10;            user.set_password(new_password)&#10;&#10;        try:&#10;            user.save()&#10;            return JsonResponse({'success': True, 'message': 'User updated successfully'})&#10;        except Exception as e:&#10;            # Catch errors like &quot;Username already taken&quot;&#10;            return JsonResponse({'success': False, 'error': str(e)}, status=400)&#10;    # delete user&#10;    def delete(self, request):&#10;        user = request.user&#10;        user.delete()&#10;        logout(request)&#10;        return JsonResponse({'success': True, 'message': 'User deleted successfully'})&#10;&#10;@method_decorator(csrf_exempt, name='dispatch')&#10;class NotificationView(View):&#10;    def dispatch(self, request, *args, **kwargs):&#10;        if not request.user.is_authenticated:&#10;            return JsonResponse({'success': False, 'error': 'Unauthorized'}, status=401)&#10;        return super().dispatch(request, *args, **kwargs)&#10;&#10;    def get(self, request):&#10;        user = request.user.pk&#10;        notifs = Notification.objects.filter(user=user).order_by('-created_at')&#10;        notif_list = [&#10;            {&#10;                &quot;notification_id&quot;: n.pk,&#10;                &quot;title&quot;: n.title,&#10;                &quot;message&quot;: n.message,&#10;                &quot;is_read&quot;: n.is_read,&#10;                &quot;created_at&quot;: n.created_at,&#10;            }&#10;            for n in notifs&#10;        ]&#10;        return JsonResponse(notif_list, safe=False)&#10;&#10;    def delete(self, request, notification_id):&#10;        notif = get_object_or_404(Notification, pk=notification_id, user=request.user.pk)&#10;        notif.delete()&#10;        return JsonResponse({'success': True, 'message': 'Notification deleted successfully'})\" />\n              <option name=\"updatedContent\" value=\"import json&#10;from django.contrib.auth import logout&#10;from django.contrib.auth.decorators import login_required&#10;from django.db import connection&#10;from django.http import JsonResponse&#10;from django.shortcuts import get_object_or_404&#10;from django.utils.decorators import method_decorator&#10;from django.views.decorators.csrf import csrf_exempt&#10;from django.views import View&#10;from django.apps import apps&#10;&#10;from .models import Notification&#10;Task = apps.get_model(app_label='task_app', model_name='Task')&#10;Project = apps.get_model(app_label='project_app', model_name='Project')&#10;CalendarEvent = apps.get_model(app_label='calendarevent_app', model_name='CalendarEvent')&#10;&#10;&#10;def decode_body(request):&#10;    try:&#10;        return json.loads(request.body.decode('utf-8'))&#10;    except json.JSONDecodeError:&#10;        return {}&#10;&#10;@login_required&#10;def get_dashboard(request):&#10;    user_id = request.user.pk&#10;&#10;    try:&#10;        with connection.cursor() as cursor:&#10;            cursor.callproc(&quot;get_user_dashboard_data&quot;, [user_id])&#10;&#10;            # Fetch the result (returns a tuple, we want the first element)&#10;            row = cursor.fetchone()&#10;&#10;            if row and row[0]:&#10;                result = row[0]&#10;                return JsonResponse(result, safe=False)&#10;            else:&#10;                # Handle case where procedure returns NULL (shouldn't happen with this SQL)&#10;                return JsonResponse({'error': 'No data returned'}, status=500)&#10;&#10;    except Exception as e:&#10;        # Log the specific error for debugging&#10;        print(f&quot;Dashboard Stored Procedure Error: {e}&quot;)&#10;        return JsonResponse({'error': 'Internal Server Error'}, status=500)&#10;&#10;@method_decorator(csrf_exempt, name='dispatch')&#10;class UserView(View):&#10;    def dispatch(self, request, *args, **kwargs):&#10;        if not request.user.is_authenticated:&#10;            return JsonResponse({'success': False, 'error': 'Unauthorized'}, status=401)&#10;        return super().dispatch(request, *args, **kwargs)&#10;&#10;    # settings&#10;    def get(self, request):&#10;        user = request.user&#10;        user_data = {&#10;            &quot;user_id&quot;: user.pk,&#10;            &quot;username&quot;: user.username,&#10;            &quot;email&quot;: user.email,&#10;            &quot;first_name&quot;: user.first_name,&#10;            &quot;last_name&quot;: user.last_name,&#10;        }&#10;        return JsonResponse(user_data)&#10;    # edit user details&#10;    def put(self, request):&#10;        data = decode_body(request)&#10;        user = request.user&#10;&#10;        # Update fields if they are provided in the request&#10;        user.username = data.get('username', user.username)&#10;        user.email = data.get('email', user.email)&#10;        user.first_name = data.get('first_name', user.first_name)&#10;        user.last_name = data.get('last_name', user.last_name)&#10;&#10;        # If password is provided, update it (make sure to hash it)&#10;        new_password = data.get('password')&#10;        if new_password:&#10;            user.set_password(new_password)&#10;&#10;        try:&#10;            user.save()&#10;            return JsonResponse({'success': True, 'message': 'User updated successfully'})&#10;        except Exception as e:&#10;            # Catch errors like &quot;Username already taken&quot;&#10;            return JsonResponse({'success': False, 'error': str(e)}, status=400)&#10;    # delete user&#10;    def delete(self, request):&#10;        user = request.user&#10;        user.delete()&#10;        logout(request)&#10;        return JsonResponse({'success': True, 'message': 'User deleted successfully'})&#10;&#10;@method_decorator(csrf_exempt, name='dispatch')&#10;class NotificationView(View):&#10;    def dispatch(self, request, *args, **kwargs):&#10;        if not request.user.is_authenticated:&#10;            return JsonResponse({'success': False, 'error': 'Unauthorized'}, status=401)&#10;        return super().dispatch(request, *args, **kwargs)&#10;&#10;    def get(self, request):&#10;        user = request.user.pk&#10;        notifs = Notification.objects.filter(user=user).order_by('-created_at')&#10;        notif_list = [&#10;            {&#10;                &quot;notification_id&quot;: n.pk,&#10;                &quot;title&quot;: n.title,&#10;                &quot;message&quot;: n.message,&#10;                &quot;is_read&quot;: n.is_read,&#10;                &quot;created_at&quot;: n.created_at,&#10;            }&#10;            for n in notifs&#10;        ]&#10;        return JsonResponse(notif_list, safe=False)&#10;&#10;    def delete(self, request, notification_id):&#10;        notif = get_object_or_404(Notification, pk=notification_id, user=request.user.pk)&#10;        notif.delete()&#10;        return JsonResponse({'success': True, 'message': 'Notification deleted successfully'})\" />\n            </PendingDiffInfo>\n          </value>\n        </entry>\n        <entry key=\"$PROJECT_DIR$/frontend/src/pages/Login.jsx\">\n          <value>\n            <PendingDiffInfo>\n              <option name=\"filePath\" value=\"$PROJECT_DIR$/frontend/src/pages/Login.jsx\" />\n              <option name=\"originalContent\" value=\"import React, {useState} from 'react'&#10;import login_illustration from '../assets/login_illustration.jpg';&#10;import { useNavigate } from 'react-router-dom'&#10;import { loginUser } from '../https';&#10;&#10;function Login() {&#10;    const [identifier, setIdentifier] = useState('');&#10;    const [password, setPassword] = useState('');&#10;    const [errorMsg, setErrorMsg] = useState('');&#10;&#10;    const navigate = useNavigate();&#10;&#10;    const handleSubmit = async (e) =&gt; {&#10;        e.preventDefault();&#10;&#10;        // Call the backend&#10;        const data = await loginUser(identifier, password);&#10;&#10;        if (data.success) {&#10;            console.log(&quot;Login Success!&quot;, data);&#10;            // Minimal compatibility fix: ProtectedRoute checks localStorage for 'authToken'.&#10;            // Store a simple token/flag so the existing guard will allow access.&#10;            try {&#10;                localStorage.setItem('authToken', data.username || 'true');&#10;            } catch (e) {&#10;                console.warn('Failed to write authToken to localStorage', e);&#10;            }&#10;            navigate('/user/dashboard');&#10;        } else {&#10;            setErrorMsg(data.error || &quot;Login failed. Please check your credentials.&quot;);&#10;        }&#10;    };&#10;    return (&#10;        &lt;div className='flex fixed items-center justify-center overflow-y-scroll inset-0 z-1000 bg-zinc-200'&gt;&#10;            &lt;div className='flex felx-row'&gt;&#10;                &lt;div className='bg-white shadow flex flex-col min-w-100 pt-3 pb-7 px-5 rounded-tl-2xl rounded-bl-2xl'&gt;&#10;&#10;                    &lt;div className='flex flex-row justify-between items-center mt-2'&gt;&#10;                        &lt;span className='font-black text-red-500 text-2xl tracking-tighter'&gt;dunzo.&lt;/span&gt;&#10;                        &lt;button className='px-3 py-2 cursor-pointer -mr-1'&#10;                            onClick={() =&gt; navigate('/')}&gt;&#10;                            &lt;i className=&quot;fa-regular fa-circle-xmark&quot;&gt;&lt;/i&gt;&#10;                        &lt;/button&gt;&#10;&#10;                    &lt;/div&gt;&#10;                    &#10;                    &lt;div className='flex flex-row gap-3 items-center'&gt;&#10;                        &lt;span className='font-bold text-gray-900 text-2xl'&gt;Welcome Back&lt;/span&gt;&#10;                        &lt;i className=&quot;fa-regular fa-hand text-red-500 text-2xl&quot;&gt;&lt;/i&gt;&#10;                    &lt;/div&gt;&#10;&#10;                    &lt;span className='text-gray-600 font-medium text-md'&gt;Log in to manage your tasks.&lt;/span&gt;&#10;&#10;                    {/* --- ERROR MESSAGE DISPLAY --- */}&#10;                    {errorMsg &amp;&amp; (&#10;                        &lt;div className=&quot;mt-2 p-2 bg-red-100 border border-red-400 text-red-700 text-sm rounded&quot;&gt;&#10;                            {errorMsg}&#10;                        &lt;/div&gt;&#10;                    )}&#10;&#10;                    {/* --- FORM START ---&#10;                        Wrapping inputs in a form allows &quot;Enter&quot; key to submit&#10;                    */}&#10;                    &lt;form onSubmit={handleSubmit} className='mt-5'&gt;&#10;&#10;                        &lt;div className='flex flex-col font-medium text-gray-900 gap-1'&gt;&#10;                            &lt;p&gt;Username/Email&lt;/p&gt;&#10;                            &lt;input&#10;                                type='text'&#10;                                placeholder='Enter your username/email'&#10;                                className='w-100 py-2 pl-2 border border-gray-400 rounded-sm'&#10;                                // 1. BIND VALUE AND ONCHANGE&#10;                                value={identifier}&#10;                                onChange={(e) =&gt; setIdentifier(e.target.value)}&#10;                            /&gt;&#10;                        &lt;/div&gt;&#10;&#10;                        &lt;div className='flex flex-col mt-4 pb-3 font-medium text-gray-900 gap-1'&gt;&#10;                            &lt;p&gt;Password&lt;/p&gt;&#10;                            &lt;div className=&quot;relative&quot;&gt; {/* Added relative for positioning if needed */}&#10;                                &lt;input&#10;                                    type='password'&#10;                                    placeholder='Password'&#10;                                    className='w-100 py-2 pl-2 border border-gray-400 rounded-sm'&#10;                                    // 2. BIND VALUE AND ONCHANGE&#10;                                    value={password}&#10;                                    onChange={(e) =&gt; setPassword(e.target.value)}&#10;                                /&gt;&#10;                                {/* Ensure eye button doesn't submit form */}&#10;                                &lt;button type=&quot;button&quot; className='absolute right-2 top-2 cursor-pointer text-gray-500'&gt;&#10;                                    &lt;i className=&quot;fa-regular fa-eye&quot;&gt;&lt;/i&gt;&#10;                                &lt;/button&gt;&#10;                            &lt;/div&gt;&#10;                        &lt;/div&gt;&#10;&#10;                        &lt;div className='flex flex-row justify-between'&gt;&#10;                            &lt;div className='flex flex-row items-center gap-2'&gt;&#10;                                &lt;input type='checkbox' className='w-3 h-3 ml-0.5'/&gt;&#10;                                &lt;p&gt;Remember me&lt;/p&gt;&#10;                            &lt;/div&gt;&#10;&#10;                            &lt;button type=&quot;button&quot; className='text-red-500 font-medium text-sm hover:underline cursor-pointer mr-1'&gt;&#10;                                Forgot Password&#10;                            &lt;/button&gt;&#10;                        &lt;/div&gt;&#10;&#10;                        {/* 3. SUBMIT BUTTON */}&#10;                        &lt;button&#10;                            type=&quot;submit&quot;&#10;                            className='w-full bg-red-500 text-md py-2 my-4 rounded-xl font-semibold text-white cursor-pointer transition duration-300 hover:-translate-y-1'&#10;                        &gt;&#10;                            Login&#10;                        &lt;/button&gt;&#10;&#10;                    &lt;/form&gt;&#10;                    {/* --- FORM END --- */}&#10;&#10;                    &lt;div className='flex flex-row gap-1 justify-center'&gt;&#10;                        &lt;p className='text-sm font-medium text-gray-700'&gt;Don't have an account?&lt;/p&gt;&#10;                        &lt;button className='text-red-500 font-semibold text-sm'&#10;                            onClick={() =&gt; navigate('/register')}&gt;&#10;                            Register&#10;                        &lt;/button&gt;&#10;                    &lt;/div&gt;&#10;                    &#10;                &lt;/div&gt;&#10;&#10;                &lt;div&gt;&#10;                    &lt;img src={login_illustration} className='h-160 rounded-tr-2xl rounded-br-2xl'/&gt;&#10;                &lt;/div&gt;&#10;            &lt;/div&gt;&#10;        &lt;/div&gt;&#10;    )&#10;}&#10;&#10;export default Login;\" />\n              <option name=\"updatedContent\" value=\"import React, {useState} from 'react'&#10;import login_illustration from '../assets/login_illustration.jpg';&#10;import { useNavigate } from 'react-router-dom'&#10;import { loginUser } from '../https';&#10;&#10;function Login() {&#10;    const [identifier, setIdentifier] = useState('');&#10;    const [password, setPassword] = useState('');&#10;    const [errorMsg, setErrorMsg] = useState('');&#10;&#10;    const navigate = useNavigate();&#10;&#10;    const handleSubmit = async (e) =&gt; {&#10;        e.preventDefault();&#10;&#10;        // Call the backend&#10;        const data = await loginUser(identifier, password);&#10;&#10;        if (data.success) {&#10;            console.log(&quot;Login Success!&quot;, data);&#10;            // Minimal compatibility fix: ProtectedRoute checks localStorage for 'authToken'.&#10;            // Store a simple token/flag so the existing guard will allow access.&#10;            try {&#10;                localStorage.setItem('authToken', data.username || 'true');&#10;            } catch (e) {&#10;                console.warn('Failed to write authToken to localStorage', e);&#10;            }&#10;            navigate('/user/dashboard');&#10;        } else {&#10;            setErrorMsg(data.error || &quot;Login failed. Please check your credentials.&quot;);&#10;        }&#10;    };&#10;    return (&#10;        &lt;div className='flex fixed items-center justify-center overflow-y-scroll inset-0 z-1000 bg-zinc-200'&gt;&#10;            &lt;div className='flex felx-row'&gt;&#10;                &lt;div className='bg-white shadow flex flex-col min-w-100 pt-3 pb-7 px-5 rounded-tl-2xl rounded-bl-2xl'&gt;&#10;&#10;                    &lt;div className='flex flex-row justify-between items-center mt-2'&gt;&#10;                        &lt;span className='font-black text-red-500 text-2xl tracking-tighter'&gt;dunzo.&lt;/span&gt;&#10;                        &lt;button className='px-3 py-2 cursor-pointer -mr-1'&#10;                            onClick={() =&gt; navigate('/')}&gt;&#10;                            &lt;i className=&quot;fa-regular fa-circle-xmark&quot;&gt;&lt;/i&gt;&#10;                        &lt;/button&gt;&#10;&#10;                    &lt;/div&gt;&#10;                    &#10;                    &lt;div className='flex flex-row gap-3 items-center'&gt;&#10;                        &lt;span className='font-bold text-gray-900 text-2xl'&gt;Welcome Back&lt;/span&gt;&#10;                        &lt;i className=&quot;fa-regular fa-hand text-red-500 text-2xl&quot;&gt;&lt;/i&gt;&#10;                    &lt;/div&gt;&#10;&#10;                    &lt;span className='text-gray-600 font-medium text-md'&gt;Log in to manage your tasks.&lt;/span&gt;&#10;&#10;                    {/* --- ERROR MESSAGE DISPLAY --- */}&#10;                    {errorMsg &amp;&amp; (&#10;                        &lt;div className=&quot;mt-2 p-2 bg-red-100 border border-red-400 text-red-700 text-sm rounded&quot;&gt;&#10;                            {errorMsg}&#10;                        &lt;/div&gt;&#10;                    )}&#10;&#10;                    {/* --- FORM START ---&#10;                        Wrapping inputs in a form allows &quot;Enter&quot; key to submit&#10;                    */}&#10;                    &lt;form onSubmit={handleSubmit} className='mt-5'&gt;&#10;&#10;                        &lt;div className='flex flex-col font-medium text-gray-900 gap-1'&gt;&#10;                            &lt;p&gt;Username/Email&lt;/p&gt;&#10;                            &lt;input&#10;                                type='text'&#10;                                placeholder='Enter your username/email'&#10;                                className='w-100 py-2 pl-2 border border-gray-400 rounded-sm'&#10;                                // 1. BIND VALUE AND ONCHANGE&#10;                                value={identifier}&#10;                                onChange={(e) =&gt; setIdentifier(e.target.value)}&#10;                            /&gt;&#10;                        &lt;/div&gt;&#10;&#10;                        &lt;div className='flex flex-col mt-4 pb-3 font-medium text-gray-900 gap-1'&gt;&#10;                            &lt;p&gt;Password&lt;/p&gt;&#10;                            &lt;div className=&quot;relative&quot;&gt; {/* Added relative for positioning if needed */}&#10;                                &lt;input&#10;                                    type='password'&#10;                                    placeholder='Password'&#10;                                    className='w-100 py-2 pl-2 border border-gray-400 rounded-sm'&#10;                                    // 2. BIND VALUE AND ONCHANGE&#10;                                    value={password}&#10;                                    onChange={(e) =&gt; setPassword(e.target.value)}&#10;                                /&gt;&#10;                                {/* Ensure eye button doesn't submit form */}&#10;                                &lt;button type=&quot;button&quot; className='absolute right-2 top-2 cursor-pointer text-gray-500'&gt;&#10;                                    &lt;i className=&quot;fa-regular fa-eye&quot;&gt;&lt;/i&gt;&#10;                                &lt;/button&gt;&#10;                            &lt;/div&gt;&#10;                        &lt;/div&gt;&#10;&#10;                        &lt;div className='flex flex-row justify-between'&gt;&#10;                            &lt;div className='flex flex-row items-center gap-2'&gt;&#10;                                &lt;input type='checkbox' className='w-3 h-3 ml-0.5'/&gt;&#10;                                &lt;p&gt;Remember me&lt;/p&gt;&#10;                            &lt;/div&gt;&#10;&#10;                            &lt;button type=&quot;button&quot; className='text-red-500 font-medium text-sm hover:underline cursor-pointer mr-1'&gt;&#10;                                Forgot Password&#10;                            &lt;/button&gt;&#10;                        &lt;/div&gt;&#10;&#10;                        {/* 3. SUBMIT BUTTON */}&#10;                        &lt;button&#10;                            type=&quot;submit&quot;&#10;                            className='w-full bg-red-500 text-md py-2 my-4 rounded-xl font-semibold text-white cursor-pointer transition duration-300 hover:-translate-y-1'&#10;                        &gt;&#10;                            Login&#10;                        &lt;/button&gt;&#10;&#10;                    &lt;/form&gt;&#10;                    {/* --- FORM END --- */}&#10;&#10;                    &lt;div className='flex flex-row gap-1 justify-center'&gt;&#10;                        &lt;p className='text-sm font-medium text-gray-700'&gt;Don't have an account?&lt;/p&gt;&#10;                        &lt;button className='text-red-500 font-semibold text-sm'&#10;                            onClick={() =&gt; navigate('/register')}&gt;&#10;                            Register&#10;                        &lt;/button&gt;&#10;                    &lt;/div&gt;&#10;                    &#10;                &lt;/div&gt;&#10;&#10;                &lt;div&gt;&#10;                    &lt;img src={login_illustration} className='h-160 rounded-tr-2xl rounded-br-2xl'/&gt;&#10;                &lt;/div&gt;&#10;            &lt;/div&gt;&#10;        &lt;/div&gt;&#10;    )&#10;}&#10;&#10;export default Login;\" />\n            </PendingDiffInfo>\n          </value>\n        </entry>\n      </map>\n    </option>\n  </component>\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/copilotDiffState.xml b/.idea/copilotDiffState.xml
--- a/.idea/copilotDiffState.xml	(revision 48f1dab1d466a2bd744f5906b2f163288adeefe0)
+++ b/.idea/copilotDiffState.xml	(date 1765842868031)
@@ -3,15 +3,6 @@
   <component name="CopilotDiffPersistence">
     <option name="pendingDiffs">
       <map>
-        <entry key="$PROJECT_DIR$/backend/dunzomanagement/project_app/views.py">
-          <value>
-            <PendingDiffInfo>
-              <option name="filePath" value="$PROJECT_DIR$/backend/dunzomanagement/project_app/views.py" />
-              <option name="originalContent" value="import json&#10;from django.contrib.auth.decorators import login_required&#10;from django.db import connection&#10;from django.http import JsonResponse&#10;from django.utils.decorators import method_decorator&#10;from django.views.decorators.csrf import csrf_exempt&#10;from django.views import View&#10;from django.apps import apps&#10;&#10;from .models import *&#10;User = apps.get_model(app_label='user_app', model_name='User')&#10;Task = apps.get_model(app_label='task_app', model_name='Task')&#10;&#10;def decode_body(request):&#10;    try:&#10;        return json.loads(request.body.decode('utf-8'))&#10;    except json.JSONDecodeError:&#10;        return {}&#10;&#10;@method_decorator(csrf_exempt, name='dispatch')&#10;class ProjectView(View):&#10;    def dispatch(self, request, *args, **kwargs):&#10;        if not request.user.is_authenticated:&#10;            return JsonResponse({'success': False, 'error': 'Unauthorized'}, status=401)&#10;        return super().dispatch(request, *args, **kwargs)&#10;    def get(self, request):&#10;        user_id = request.user.pk&#10;&#10;        filter_type = request.GET.get('filter', 'Active')&#10;&#10;        # Validate filter to prevent SQL issues (optional but good practice)&#10;        valid_filters = ['Active', 'Archived', 'Complete', 'All', 'Leader']&#10;        if filter_type not in valid_filters:&#10;            filter_type = 'Active'&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Call the Stored Procedure&#10;                cursor.callproc(&quot;get_user_projects&quot;, [user_id, filter_type])&#10;&#10;                # Fetch the JSON result&#10;                projects_data = cursor.fetchone()[0]&#10;&#10;                return JsonResponse({'success': True, 'projects': projects_data})&#10;&#10;        except Exception as e:&#10;            print(f&quot;Get Projects Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': 'Internal Server Error'}, status=500)&#10;    def post(self, request):&#10;        data = decode_body(request)&#10;&#10;        # Extract data from the request body&#10;        user_id = request.user.pk&#10;        title = data.get('title')&#10;        description = data.get('description', '')  # Default to empty string if missing&#10;        start_date = data.get('start_date')&#10;        end_date = data.get('end_date')&#10;&#10;        # Basic Validation&#10;        if not title or not start_date or not end_date:&#10;            return JsonResponse({&#10;                'success': False,&#10;                'error': 'Title, Start Date, and End Date are required.'&#10;            }, status=400)&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Signature: (p_user_id, p_title, p_description, p_start_date, p_end_date)&#10;                cursor.callproc(&#10;                    &quot;create_project&quot;,&#10;                    [user_id, title, description, start_date, end_date]&#10;                )&#10;&#10;                # Fetch the returned Project ID&#10;                new_project_id = cursor.fetchone()[0]&#10;&#10;                return JsonResponse({&#10;                    'success': True,&#10;                    'message': 'Project created successfully',&#10;                    'project_id': new_project_id&#10;                }, status=201)&#10;&#10;        except Exception as e:&#10;            # Log error for debugging (optional)&#10;            print(f&quot;Create Project Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': str(e)}, status=500)&#10;    def delete(self, request):&#10;        user_id = request.user.pk&#10;&#10;        data = decode_body(request)&#10;        project_id = data.get('project_id')&#10;&#10;        if not project_id:&#10;            return JsonResponse({'success': False, 'error': 'Project ID is required'}, status=400)&#10;&#10;        try:&#10;            # 1. Security Check: Only the 'Leader' can delete&#10;            # We check if a membership exists that matches: User + Project + Role='Leader'&#10;            is_leader = ProjectMembership.objects.filter(&#10;                project_id=project_id,&#10;                user_id=user_id,&#10;                role='Leader'&#10;            ).exists()&#10;&#10;            if not is_leader:&#10;                return JsonResponse({&#10;                    'success': False,&#10;                    'error': 'Permission denied. Only the Leader can delete this project.'&#10;                }, status=403)&#10;&#10;            # 2. Perform Delete&#10;            Project.objects.get(pk=project_id).delete()&#10;&#10;            return JsonResponse({'success': True, 'message': 'Project deleted successfully'})&#10;&#10;        except Project.DoesNotExist:&#10;            return JsonResponse({'success': False, 'error': 'Project not found'}, status=404)&#10;        except Exception as e:&#10;            return JsonResponse({'success': False, 'error': str(e)}, status=500)&#10;&#10;@method_decorator(csrf_exempt, name='dispatch')&#10;class ProjectDetailView(View):&#10;    def dispatch(self, request, *args, **kwargs):&#10;        if not request.user.is_authenticated:&#10;            return JsonResponse({'success': False, 'error': 'Unauthorized'}, status=401)&#10;        return super().dispatch(request, *args, **kwargs)&#10;    # get project details&#10;    def get(self, request):&#10;        project_id = request.GET.get('project_id')&#10;        user_id = request.user.pk&#10;&#10;        if not project_id:&#10;            return JsonResponse({'success': False, 'error': 'Project ID is required.'}, status=400)&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Call Stored Procedure&#10;                # Signature: (p_project_id, p_user_id)&#10;                cursor.callproc(&#10;                    &quot;get_project_details&quot;,&#10;                    [project_id, user_id]&#10;                )&#10;&#10;                # Fetch the single JSON blob result&#10;                result = cursor.fetchone()[0]&#10;&#10;                # Check status code based on result success&#10;                if result.get('success'):&#10;                    return JsonResponse(result)&#10;                else:&#10;                    # Determine error code (403 for Unauthorized, 404 for Not Found)&#10;                    error_msg = result.get('error', '')&#10;                    status_code = 403 if 'Unauthorized' in error_msg else 404&#10;                    return JsonResponse(result, status=status_code)&#10;&#10;        except Exception as e:&#10;            print(f&quot;Get Project Details Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': 'Internal Server Error'}, status=500)&#10;    # update project details&#10;    def put(self, request):&#10;        data = decode_body(request)&#10;        user_id = request.user.pk&#10;&#10;        project_id = data.get('project_id')&#10;        title = data.get('title')&#10;        description = data.get('description', '')&#10;        start_date = data.get('start_date')&#10;        end_date = data.get('end_date')&#10;        status = data.get('status')&#10;&#10;        # Basic Validation&#10;        if not project_id or not title or not start_date or not end_date:&#10;            return JsonResponse({&#10;                'success': False,&#10;                'error': 'Project ID, Title, and Dates are required.'&#10;            }, status=400)&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Signature: (p_project_id, p_user_id, p_title, p_description, p_start_date, p_end_date,status)&#10;                cursor.callproc(&#10;                    &quot;update_project&quot;,&#10;                    [project_id, user_id, title, description, start_date, end_date, status]&#10;                )&#10;&#10;                # The procedure returns True (Success) or False (Not Leader/Failed)&#10;                success = cursor.fetchone()[0]&#10;&#10;                if success:&#10;                    return JsonResponse({'success': True, 'message': 'Project updated successfully'})&#10;                else:&#10;                    return JsonResponse({&#10;                        'success': False,&#10;                        'error': 'Permission denied. Only the Leader can edit this project.'&#10;                    }, status=403)&#10;&#10;        except Exception as e:&#10;            print(f&quot;Update Project Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': str(e)}, status=500)&#10;&#10;@method_decorator(csrf_exempt, name='dispatch')&#10;class ProjectMembershipView(View):&#10;    def dispatch(self, request, *args, **kwargs):&#10;        if not request.user.is_authenticated:&#10;            return JsonResponse({'success': False, 'error': 'Unauthorized'}, status=401)&#10;        return super().dispatch(request, *args, **kwargs)&#10;    # add a user to project&#10;    def post(self, request):&#10;        data = decode_body(request)&#10;        requester_id = request.user.pk&#10;&#10;        # Parse inputs&#10;        project_id = data.get('project_id')&#10;        identifier = data.get('identifier')&#10;        role = data.get('role', 'Member')  # Default to 'Member' if not provided&#10;&#10;        # Basic Validation&#10;        if not project_id or not identifier:&#10;            return JsonResponse({'success': False, 'error': 'Project ID and Username/Email are required.'}, status=400)&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Signature: (p_project_id, p_requester_id, p_identifier, p_role)&#10;                cursor.callproc(&#10;                    &quot;add_project_member&quot;,&#10;                    [project_id, requester_id, identifier, role]&#10;                )&#10;&#10;                result = cursor.fetchone()[0]&#10;&#10;                if result.get('success'):&#10;                    return JsonResponse(result, status=201)&#10;                else:&#10;                    # Return 400 or 403 depending on the error, but 400 is generally fine here&#10;                    return JsonResponse(result, status=400)&#10;&#10;        except Exception as e:&#10;            print(f&quot;Add Member Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': 'Internal Server Error'}, status=500)&#10;    # remove a user fron project&#10;    def delete(self, request):&#10;        data = decode_body(request)&#10;        requester_id = request.user.pk&#10;&#10;        project_id = data.get('project_id')&#10;        target_user_id = data.get('user_id')&#10;&#10;        # Basic Validation&#10;        if not project_id or not target_user_id:&#10;            return JsonResponse({'success': False, 'error': 'Project ID and Target User ID are required.'}, status=400)&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Signature: (p_project_id, p_requester_id, p_target_user_id)&#10;                cursor.callproc(&#10;                    &quot;remove_project_member&quot;,&#10;                    [project_id, requester_id, target_user_id]&#10;                )&#10;&#10;                # Fetch result&#10;                result = cursor.fetchone()[0]&#10;&#10;                if result.get('success'):&#10;                    return JsonResponse(result)&#10;                else:&#10;                    # Return 403 Forbidden if permission/safety check failed&#10;                    return JsonResponse(result, status=403)&#10;&#10;        except Exception as e:&#10;            print(f&quot;Remove Member Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': 'Internal Server Error'}, status=500)&#10;    # change user role in project&#10;    def put(self, request):&#10;        data = decode_body(request)&#10;        requester_id = request.user.pk  # The logged-in user (must be Leader)&#10;&#10;        # Parse inputs&#10;        project_id = data.get('project_id')&#10;        target_user_id = data.get('user_id')  # The user receiving the role change&#10;        new_role = data.get('role')&#10;&#10;        # Basic Validation&#10;        if not all([project_id, target_user_id, new_role]):&#10;            return JsonResponse({'success': False, 'error': 'Project ID, Target User ID, and Role are required.'},&#10;                                status=400)&#10;&#10;        valid_roles = ['Leader', 'Manager', 'Member']&#10;        if new_role not in valid_roles:&#10;            return JsonResponse({'success': False, 'error': 'Invalid role choice.'}, status=400)&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Call Stored Procedure&#10;                # Signature: (p_project_id, p_requester_id, p_target_user_id, p_new_role)&#10;                cursor.callproc(&#10;                    &quot;update_project_member_role&quot;,&#10;                    [project_id, requester_id, target_user_id, new_role]&#10;                )&#10;&#10;                # The SP returns a JSON object directly&#10;                result = cursor.fetchone()[0]&#10;&#10;                # Check the 'success' key from the returned JSON&#10;                if result.get('success'):&#10;                    return JsonResponse(result)&#10;                else:&#10;                    # Return 403 Forbidden if permission/safety check failed&#10;                    return JsonResponse(result, status=403)&#10;&#10;        except Exception as e:&#10;            print(f&quot;Update Role Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': 'Internal Server Error'}, status=500)&#10;&#10;@method_decorator(csrf_exempt, name='dispatch')&#10;class TagView(View):&#10;    def dispatch(self, request, *args, **kwargs):&#10;        if not request.user.is_authenticated:&#10;            return JsonResponse({'success': False, 'error': 'Unauthorized'}, status=401)&#10;        return super().dispatch(request, *args, **kwargs)&#10;    # create tag&#10;    def post(self, request):&#10;        data = decode_body(request)&#10;        project_id = data.get('project_id')&#10;        name = data.get('name')&#10;        hex_color = data.get('hex_color', '#000000')&#10;&#10;        if not project_id or not name:&#10;            return JsonResponse({'success': False, 'error': 'Project ID and Name are required.'}, status=400)&#10;&#10;        try:&#10;            # PERMISSION CHECK: Must be Leader or Manager&#10;            has_permission = ProjectMembership.objects.filter(&#10;                project_id=project_id,&#10;                user_id=request.user.pk,&#10;                role__in=['Leader', 'Manager']  # &lt;--- Strict Check&#10;            ).exists()&#10;&#10;            if not has_permission:&#10;                return JsonResponse({'success': False, 'error': 'Only Leaders or Managers can create tags.'},&#10;                                    status=403)&#10;&#10;            # Create&#10;            tag = Tag.objects.create(&#10;                project_id=project_id,&#10;                name=name,&#10;                hex_color=hex_color&#10;            )&#10;&#10;            return JsonResponse({&#10;                'success': True,&#10;                'tag': {'tag_id': tag.tag_id, 'name': tag.name, 'hex_color': tag.hex_color}&#10;            }, status=201)&#10;&#10;        except Exception as e:&#10;            return JsonResponse({'success': False, 'error': str(e)}, status=500)&#10;    # edit tag&#10;    def put(self, request):&#10;        data = decode_body(request)&#10;        tag_id = data.get('tag_id')&#10;        name = data.get('name')&#10;        hex_color = data.get('hex_color')&#10;&#10;        if not tag_id:&#10;            return JsonResponse({'success': False, 'error': 'Tag ID is required.'}, status=400)&#10;&#10;        try:&#10;            tag = Tag.objects.get(pk=tag_id)&#10;&#10;            # PERMISSION CHECK&#10;            has_permission = ProjectMembership.objects.filter(&#10;                project_id=tag.project_id,&#10;                user_id=request.user.pk,&#10;                role__in=['Leader', 'Manager']&#10;            ).exists()&#10;&#10;            if not has_permission:&#10;                return JsonResponse({'success': False, 'error': 'Only Leaders or Managers can edit tags.'}, status=403)&#10;&#10;            if name:&#10;                tag.name = name&#10;            if hex_color:&#10;                tag.hex_color = hex_color&#10;&#10;            tag.save()&#10;&#10;            return JsonResponse({'success': True, 'message': 'Tag updated successfully.'})&#10;&#10;        except Tag.DoesNotExist:&#10;            return JsonResponse({'success': False, 'error': 'Tag not found.'}, status=404)&#10;        except Exception as e:&#10;            return JsonResponse({'success': False, 'error': str(e)}, status=500)&#10;    # delete tag&#10;    def delete(self, request):&#10;        data = decode_body(request)&#10;        tag_id = data.get('tag_id')&#10;&#10;        if not tag_id:&#10;            return JsonResponse({'success': False, 'error': 'Tag ID is required.'}, status=400)&#10;&#10;        try:&#10;            tag = Tag.objects.get(pk=tag_id)&#10;&#10;            # PERMISSION CHECK&#10;            has_permission = ProjectMembership.objects.filter(&#10;                project_id=tag.project_id,&#10;                user_id=request.user.pk,&#10;                role__in=['Leader', 'Manager']&#10;            ).exists()&#10;&#10;            if not has_permission:&#10;                return JsonResponse({'success': False, 'error': 'Only Leaders or Managers can delete tags.'}, status=403)&#10;&#10;            tag.delete()&#10;&#10;            return JsonResponse({'success': True, 'message': 'Tag deleted successfully.'})&#10;&#10;        except Tag.DoesNotExist:&#10;            return JsonResponse({'success': False, 'error': 'Tag not found.'}, status=404)&#10;        except Exception as e:&#10;            return JsonResponse({'success': False, 'error': str(e)}, status=500)&#10;" />
-              <option name="updatedContent" value="import json&#10;from django.contrib.auth.decorators import login_required&#10;from django.db import connection&#10;from django.http import JsonResponse&#10;from django.utils.decorators import method_decorator&#10;from django.views.decorators.csrf import csrf_exempt&#10;from django.views import View&#10;from django.apps import apps&#10;&#10;from .models import *&#10;User = apps.get_model(app_label='user_app', model_name='User')&#10;Task = apps.get_model(app_label='task_app', model_name='Task')&#10;&#10;def decode_body(request):&#10;    try:&#10;        return json.loads(request.body.decode('utf-8'))&#10;    except json.JSONDecodeError:&#10;        return {}&#10;&#10;@method_decorator(csrf_exempt, name='dispatch')&#10;class ProjectView(View):&#10;    def dispatch(self, request, *args, **kwargs):&#10;        if not request.user.is_authenticated:&#10;            return JsonResponse({'success': False, 'error': 'Unauthorized'}, status=401)&#10;        return super().dispatch(request, *args, **kwargs)&#10;    def get(self, request):&#10;        user_id = request.user.pk&#10;&#10;        filter_type = request.GET.get('filter', 'Active')&#10;&#10;        # Validate filter to prevent SQL issues (optional but good practice)&#10;        valid_filters = ['Active', 'Archived', 'Complete', 'All', 'Leader']&#10;        if filter_type not in valid_filters:&#10;            filter_type = 'Active'&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Call the Stored Procedure&#10;                cursor.callproc(&quot;get_user_projects&quot;, [user_id, filter_type])&#10;&#10;                # Fetch the JSON result&#10;                projects_data = cursor.fetchone()[0]&#10;&#10;                return JsonResponse({'success': True, 'projects': projects_data})&#10;&#10;        except Exception as e:&#10;            print(f&quot;Get Projects Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': 'Internal Server Error'}, status=500)&#10;    def post(self, request):&#10;        data = decode_body(request)&#10;&#10;        # Extract data from the request body&#10;        user_id = request.user.pk&#10;        title = data.get('title')&#10;        description = data.get('description', '')  # Default to empty string if missing&#10;        start_date = data.get('start_date')&#10;        end_date = data.get('end_date')&#10;&#10;        # Basic Validation&#10;        if not title or not start_date or not end_date:&#10;            return JsonResponse({&#10;                'success': False,&#10;                'error': 'Title, Start Date, and End Date are required.'&#10;            }, status=400)&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Signature: (p_user_id, p_title, p_description, p_start_date, p_end_date)&#10;                cursor.callproc(&#10;                    &quot;create_project&quot;,&#10;                    [user_id, title, description, start_date, end_date]&#10;                )&#10;&#10;                # Fetch the returned Project ID&#10;                new_project_id = cursor.fetchone()[0]&#10;&#10;                return JsonResponse({&#10;                    'success': True,&#10;                    'message': 'Project created successfully',&#10;                    'project_id': new_project_id&#10;                }, status=201)&#10;&#10;        except Exception as e:&#10;            # Log error for debugging (optional)&#10;            print(f&quot;Create Project Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': str(e)}, status=500)&#10;    def delete(self, request):&#10;        user_id = request.user.pk&#10;&#10;        data = decode_body(request)&#10;        project_id = data.get('project_id')&#10;&#10;        if not project_id:&#10;            return JsonResponse({'success': False, 'error': 'Project ID is required'}, status=400)&#10;&#10;        try:&#10;            # 1. Security Check: Only the 'Leader' can delete&#10;            # We check if a membership exists that matches: User + Project + Role='Leader'&#10;            is_leader = ProjectMembership.objects.filter(&#10;                project_id=project_id,&#10;                user_id=user_id,&#10;                role='Leader'&#10;            ).exists()&#10;&#10;            if not is_leader:&#10;                return JsonResponse({&#10;                    'success': False,&#10;                    'error': 'Permission denied. Only the Leader can delete this project.'&#10;                }, status=403)&#10;&#10;            # 2. Perform Delete&#10;            Project.objects.get(pk=project_id).delete()&#10;&#10;            return JsonResponse({'success': True, 'message': 'Project deleted successfully'})&#10;&#10;        except Project.DoesNotExist:&#10;            return JsonResponse({'success': False, 'error': 'Project not found'}, status=404)&#10;        except Exception as e:&#10;            return JsonResponse({'success': False, 'error': str(e)}, status=500)&#10;&#10;@method_decorator(csrf_exempt, name='dispatch')&#10;class ProjectDetailView(View):&#10;    def dispatch(self, request, *args, **kwargs):&#10;        if not request.user.is_authenticated:&#10;            return JsonResponse({'success': False, 'error': 'Unauthorized'}, status=401)&#10;        return super().dispatch(request, *args, **kwargs)&#10;    # get project details&#10;    def get(self, request):&#10;        project_id = request.GET.get('project_id')&#10;        user_id = request.user.pk&#10;&#10;        if not project_id:&#10;            return JsonResponse({'success': False, 'error': 'Project ID is required.'}, status=400)&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Call Stored Procedure&#10;                # Signature: (p_project_id, p_user_id)&#10;                cursor.callproc(&#10;                    &quot;get_project_details&quot;,&#10;                    [project_id, user_id]&#10;                )&#10;&#10;                # Fetch the single JSON blob result&#10;                result = cursor.fetchone()[0]&#10;&#10;                # Check status code based on result success&#10;                if result.get('success'):&#10;                    return JsonResponse(result)&#10;                else:&#10;                    # Determine error code (403 for Unauthorized, 404 for Not Found)&#10;                    error_msg = result.get('error', '')&#10;                    status_code = 403 if 'Unauthorized' in error_msg else 404&#10;                    return JsonResponse(result, status=status_code)&#10;&#10;        except Exception as e:&#10;            print(f&quot;Get Project Details Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': 'Internal Server Error'}, status=500)&#10;    # update project details&#10;    def put(self, request):&#10;        data = decode_body(request)&#10;        user_id = request.user.pk&#10;&#10;        project_id = data.get('project_id')&#10;        title = data.get('title')&#10;        description = data.get('description', '')&#10;        start_date = data.get('start_date')&#10;        end_date = data.get('end_date')&#10;        status = data.get('status')&#10;&#10;        # Basic Validation&#10;        if not project_id or not title or not start_date or not end_date:&#10;            return JsonResponse({&#10;                'success': False,&#10;                'error': 'Project ID, Title, and Dates are required.'&#10;            }, status=400)&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Signature: (p_project_id, p_user_id, p_title, p_description, p_start_date, p_end_date,status)&#10;                cursor.callproc(&#10;                    &quot;update_project&quot;,&#10;                    [project_id, user_id, title, description, start_date, end_date, status]&#10;                )&#10;&#10;                # The procedure returns True (Success) or False (Not Leader/Failed)&#10;                success = cursor.fetchone()[0]&#10;&#10;                if success:&#10;                    return JsonResponse({'success': True, 'message': 'Project updated successfully'})&#10;                else:&#10;                    return JsonResponse({&#10;                        'success': False,&#10;                        'error': 'Permission denied. Only the Leader can edit this project.'&#10;                    }, status=403)&#10;&#10;        except Exception as e:&#10;            print(f&quot;Update Project Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': str(e)}, status=500)&#10;&#10;@method_decorator(csrf_exempt, name='dispatch')&#10;class ProjectMembershipView(View):&#10;    def dispatch(self, request, *args, **kwargs):&#10;        if not request.user.is_authenticated:&#10;            return JsonResponse({'success': False, 'error': 'Unauthorized'}, status=401)&#10;        return super().dispatch(request, *args, **kwargs)&#10;    # add a user to project&#10;    def post(self, request):&#10;        data = decode_body(request)&#10;        requester_id = request.user.pk&#10;&#10;        # Parse inputs&#10;        project_id = data.get('project_id')&#10;        identifier = data.get('identifier')&#10;        role = data.get('role', 'Member')  # Default to 'Member' if not provided&#10;&#10;        # Basic Validation&#10;        if not project_id or not identifier:&#10;            return JsonResponse({'success': False, 'error': 'Project ID and Username/Email are required.'}, status=400)&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Signature: (p_project_id, p_requester_id, p_identifier, p_role)&#10;                cursor.callproc(&#10;                    &quot;add_project_member&quot;,&#10;                    [project_id, requester_id, identifier, role]&#10;                )&#10;&#10;                result = cursor.fetchone()[0]&#10;&#10;                if result.get('success'):&#10;                    return JsonResponse(result, status=201)&#10;                else:&#10;                    # Return 400 or 403 depending on the error, but 400 is generally fine here&#10;                    return JsonResponse(result, status=400)&#10;&#10;        except Exception as e:&#10;            print(f&quot;Add Member Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': 'Internal Server Error'}, status=500)&#10;    # remove a user fron project&#10;    def delete(self, request):&#10;        data = decode_body(request)&#10;        requester_id = request.user.pk&#10;&#10;        project_id = data.get('project_id')&#10;        target_user_id = data.get('user_id')&#10;&#10;        # Basic Validation&#10;        if not project_id or not target_user_id:&#10;            return JsonResponse({'success': False, 'error': 'Project ID and Target User ID are required.'}, status=400)&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Signature: (p_project_id, p_requester_id, p_target_user_id)&#10;                cursor.callproc(&#10;                    &quot;remove_project_member&quot;,&#10;                    [project_id, requester_id, target_user_id]&#10;                )&#10;&#10;                # Fetch result&#10;                result = cursor.fetchone()[0]&#10;&#10;                if result.get('success'):&#10;                    return JsonResponse(result)&#10;                else:&#10;                    # Return 403 Forbidden if permission/safety check failed&#10;                    return JsonResponse(result, status=403)&#10;&#10;        except Exception as e:&#10;            print(f&quot;Remove Member Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': 'Internal Server Error'}, status=500)&#10;    # change user role in project&#10;    def put(self, request):&#10;        data = decode_body(request)&#10;        requester_id = request.user.pk  # The logged-in user (must be Leader)&#10;&#10;        # Parse inputs&#10;        project_id = data.get('project_id')&#10;        target_user_id = data.get('user_id')  # The user receiving the role change&#10;        new_role = data.get('role')&#10;&#10;        # Basic Validation&#10;        if not all([project_id, target_user_id, new_role]):&#10;            return JsonResponse({'success': False, 'error': 'Project ID, Target User ID, and Role are required.'},&#10;                                status=400)&#10;&#10;        valid_roles = ['Leader', 'Manager', 'Member']&#10;        if new_role not in valid_roles:&#10;            return JsonResponse({'success': False, 'error': 'Invalid role choice.'}, status=400)&#10;&#10;        try:&#10;            with connection.cursor() as cursor:&#10;                # Call Stored Procedure&#10;                # Signature: (p_project_id, p_requester_id, p_target_user_id, p_new_role)&#10;                cursor.callproc(&#10;                    &quot;update_project_member_role&quot;,&#10;                    [project_id, requester_id, target_user_id, new_role]&#10;                )&#10;&#10;                # The SP returns a JSON object directly&#10;                result = cursor.fetchone()[0]&#10;&#10;                # Check the 'success' key from the returned JSON&#10;                if result.get('success'):&#10;                    return JsonResponse(result)&#10;                else:&#10;                    # Return 403 Forbidden if permission/safety check failed&#10;                    return JsonResponse(result, status=403)&#10;&#10;        except Exception as e:&#10;            print(f&quot;Update Role Error: {e}&quot;)&#10;            return JsonResponse({'success': False, 'error': 'Internal Server Error'}, status=500)&#10;&#10;@method_decorator(csrf_exempt, name='dispatch')&#10;class TagView(View):&#10;    def dispatch(self, request, *args, **kwargs):&#10;        if not request.user.is_authenticated:&#10;            return JsonResponse({'success': False, 'error': 'Unauthorized'}, status=401)&#10;        return super().dispatch(request, *args, **kwargs)&#10;    # create tag&#10;    def post(self, request):&#10;        data = decode_body(request)&#10;        project_id = data.get('project_id')&#10;        name = data.get('name')&#10;        hex_color = data.get('hex_color', '#000000')&#10;&#10;        if not project_id or not name:&#10;            return JsonResponse({'success': False, 'error': 'Project ID and Name are required.'}, status=400)&#10;&#10;        try:&#10;            # PERMISSION CHECK: Must be Leader or Manager&#10;            has_permission = ProjectMembership.objects.filter(&#10;                project_id=project_id,&#10;                user_id=request.user.pk,&#10;                role__in=['Leader', 'Manager']  # &lt;--- Strict Check&#10;            ).exists()&#10;&#10;            if not has_permission:&#10;                return JsonResponse({'success': False, 'error': 'Only Leaders or Managers can create tags.'},&#10;                                    status=403)&#10;&#10;            # Create&#10;            tag = Tag.objects.create(&#10;                project_id=project_id,&#10;                name=name,&#10;                hex_color=hex_color&#10;            )&#10;&#10;            return JsonResponse({&#10;                'success': True,&#10;                'tag': {'tag_id': tag.tag_id, 'name': tag.name, 'hex_color': tag.hex_color}&#10;            }, status=201)&#10;&#10;        except Exception as e:&#10;            return JsonResponse({'success': False, 'error': str(e)}, status=500)&#10;    # edit tag&#10;    def put(self, request):&#10;        data = decode_body(request)&#10;        tag_id = data.get('tag_id')&#10;        name = data.get('name')&#10;        hex_color = data.get('hex_color')&#10;&#10;        if not tag_id:&#10;            return JsonResponse({'success': False, 'error': 'Tag ID is required.'}, status=400)&#10;&#10;        try:&#10;            tag = Tag.objects.get(pk=tag_id)&#10;&#10;            # PERMISSION CHECK&#10;            has_permission = ProjectMembership.objects.filter(&#10;                project_id=tag.project_id,&#10;                user_id=request.user.pk,&#10;                role__in=['Leader', 'Manager']&#10;            ).exists()&#10;&#10;            if not has_permission:&#10;                return JsonResponse({'success': False, 'error': 'Only Leaders or Managers can edit tags.'}, status=403)&#10;&#10;            if name:&#10;                tag.name = name&#10;            if hex_color:&#10;                tag.hex_color = hex_color&#10;&#10;            tag.save()&#10;&#10;            return JsonResponse({'success': True, 'message': 'Tag updated successfully.'})&#10;&#10;        except Tag.DoesNotExist:&#10;            return JsonResponse({'success': False, 'error': 'Tag not found.'}, status=404)&#10;        except Exception as e:&#10;            return JsonResponse({'success': False, 'error': str(e)}, status=500)&#10;    # delete tag&#10;    def delete(self, request):&#10;        data = decode_body(request)&#10;        tag_id = data.get('tag_id')&#10;&#10;        if not tag_id:&#10;            return JsonResponse({'success': False, 'error': 'Tag ID is required.'}, status=400)&#10;&#10;        try:&#10;            tag = Tag.objects.get(pk=tag_id)&#10;&#10;            # PERMISSION CHECK&#10;            has_permission = ProjectMembership.objects.filter(&#10;                project_id=tag.project_id,&#10;                user_id=request.user.pk,&#10;                role__in=['Leader', 'Manager']&#10;            ).exists()&#10;&#10;            if not has_permission:&#10;                return JsonResponse({'success': False, 'error': 'Only Leaders or Managers can delete tags.'}, status=403)&#10;&#10;            tag.delete()&#10;&#10;            return JsonResponse({'success': True, 'message': 'Tag deleted successfully.'})&#10;&#10;        except Tag.DoesNotExist:&#10;            return JsonResponse({'success': False, 'error': 'Tag not found.'}, status=404)&#10;        except Exception as e:&#10;            return JsonResponse({'success': False, 'error': str(e)}, status=500)" />
-            </PendingDiffInfo>
-          </value>
-        </entry>
         <entry key="$PROJECT_DIR$/backend/dunzomanagement/user_app/views.py">
           <value>
             <PendingDiffInfo>
Index: .idea/workspace.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project version=\"4\">\n  <component name=\"AutoImportSettings\">\n    <option name=\"autoReloadType\" value=\"SELECTIVE\" />\n  </component>\n  <component name=\"ChangeListManager\">\n    <list default=\"true\" id=\"33aa42ef-630d-454b-aadd-8426bf50f91a\" name=\"Changes\" comment=\"\">\n      <change beforePath=\"$PROJECT_DIR$/.idea/workspace.xml\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/.idea/workspace.xml\" afterDir=\"false\" />\n    </list>\n    <option name=\"SHOW_DIALOG\" value=\"false\" />\n    <option name=\"HIGHLIGHT_CONFLICTS\" value=\"true\" />\n    <option name=\"HIGHLIGHT_NON_ACTIVE_CHANGELIST\" value=\"false\" />\n    <option name=\"LAST_RESOLUTION\" value=\"IGNORE\" />\n  </component>\n  <component name=\"DjangoConsoleOptions\" custom-start-script=\"import sys; print('Python %s on %s' % (sys.version, sys.platform))&#10;import django; print('Django %s' % django.get_version())&#10;sys.path.extend([WORKING_DIR_AND_PYTHON_PATHS])&#10;if 'setup' in dir(django): django.setup()&#10;import django_manage_shell; django_manage_shell.run(PROJECT_ROOT)\">\n    <option name=\"myCustomStartScript\" value=\"import sys; print('Python %s on %s' % (sys.version, sys.platform))&#10;import django; print('Django %s' % django.get_version())&#10;sys.path.extend([WORKING_DIR_AND_PYTHON_PATHS])&#10;if 'setup' in dir(django): django.setup()&#10;import django_manage_shell; django_manage_shell.run(PROJECT_ROOT)\" />\n  </component>\n  <component name=\"FileTemplateManagerImpl\">\n    <option name=\"RECENT_TEMPLATES\">\n      <list>\n        <option value=\"Python Script\" />\n        <option value=\"JavaScript File\" />\n        <option value=\"JSX File\" />\n      </list>\n    </option>\n  </component>\n  <component name=\"Git.Settings\">\n    <option name=\"RECENT_BRANCH_BY_REPOSITORY\">\n      <map>\n        <entry key=\"$PROJECT_DIR$\" value=\"auth\" />\n      </map>\n    </option>\n    <option name=\"RECENT_GIT_ROOT_PATH\" value=\"$PROJECT_DIR$\" />\n  </component>\n  <component name=\"GitHubPullRequestSearchHistory\">{\n  &quot;lastFilter&quot;: {\n    &quot;state&quot;: &quot;OPEN&quot;,\n    &quot;assignee&quot;: &quot;DMKuZu&quot;\n  }\n}</component>\n  <component name=\"GithubPullRequestsUISettings\"><![CDATA[{\n  \"selectedUrlAndAccountId\": {\n    \"url\": \"https://github.com/Libron-ChristianNeil/Dunzo_ProjectDB.git\",\n    \"accountId\": \"87048f45-fda5-4f2e-b05d-cc22aa78e906\"\n  }\n}]]></component>\n  <component name=\"ProjectColorInfo\">{\n  &quot;associatedIndex&quot;: 3\n}</component>\n  <component name=\"ProjectId\" id=\"35kSkIpqhZcelkSjJpCTWayOGFu\" />\n  <component name=\"ProjectLevelVcsManager\">\n    <ConfirmationsSetting value=\"2\" id=\"Add\" />\n  </component>\n  <component name=\"ProjectViewState\">\n    <option name=\"hideEmptyMiddlePackages\" value=\"true\" />\n    <option name=\"showLibraryContents\" value=\"true\" />\n  </component>\n  <component name=\"PropertiesComponent\">{\n  &quot;keyToString&quot;: {\n    &quot;ModuleVcsDetector.initialDetectionPerformed&quot;: &quot;true&quot;,\n    &quot;Python.views.executor&quot;: &quot;Run&quot;,\n    &quot;RunOnceActivity.OpenDjangoStructureViewOnStart&quot;: &quot;true&quot;,\n    &quot;RunOnceActivity.ShowReadmeOnStart&quot;: &quot;true&quot;,\n    &quot;RunOnceActivity.TerminalTabsStorage.copyFrom.TerminalArrangementManager.252&quot;: &quot;true&quot;,\n    &quot;RunOnceActivity.git.unshallow&quot;: &quot;true&quot;,\n    &quot;SHARE_PROJECT_CONFIGURATION_FILES&quot;: &quot;true&quot;,\n    &quot;SHELLCHECK.PATH&quot;: &quot;I do mind&quot;,\n    &quot;Shell Script.Full Stack.executor&quot;: &quot;Run&quot;,\n    &quot;git-widget-placeholder&quot;: &quot;FULLSTACK&quot;,\n    &quot;junie.onboarding.icon.badge.shown&quot;: &quot;true&quot;,\n    &quot;last_opened_file_path&quot;: &quot;/home/kuzu/PycharmProjects/Dunzo_ProjectDB/run_fullstack.sh&quot;,\n    &quot;node.js.detected.package.eslint&quot;: &quot;true&quot;,\n    &quot;node.js.detected.package.tslint&quot;: &quot;true&quot;,\n    &quot;node.js.selected.package.eslint&quot;: &quot;(autodetect)&quot;,\n    &quot;node.js.selected.package.tslint&quot;: &quot;(autodetect)&quot;,\n    &quot;nodejs_package_manager_path&quot;: &quot;npm&quot;,\n    &quot;settings.editor.selected.configurable&quot;: &quot;com.jetbrains.python.configuration.PyActiveSdkModuleConfigurable&quot;,\n    &quot;to.speed.mode.migration.done&quot;: &quot;true&quot;,\n    &quot;ts.external.directory.path&quot;: &quot;/home/kuzu/.local/share/JetBrains/Toolbox/apps/pycharm/plugins/javascript-plugin/jsLanguageServicesImpl/external&quot;,\n    &quot;vue.rearranger.settings.migration&quot;: &quot;true&quot;\n  }\n}</component>\n  <component name=\"RecentsManager\">\n    <key name=\"CopyFile.RECENT_KEYS\">\n      <recent name=\"$PROJECT_DIR$/backend/dunzomanagement\" />\n      <recent name=\"$PROJECT_DIR$/dunzomanagement/timeline_app/static/timeline_app/css\" />\n      <recent name=\"$PROJECT_DIR$/dunzomanagement/timeline_app/templates/timeline_app\" />\n      <recent name=\"$PROJECT_DIR$/dunzomanagement/task_app/static/task_app/css\" />\n      <recent name=\"$PROJECT_DIR$/dunzomanagement/task_app/templates/task_app\" />\n    </key>\n    <key name=\"MoveFile.RECENT_KEYS\">\n      <recent name=\"$PROJECT_DIR$/dunzomanagement/dunzomanagement/templates/main\" />\n      <recent name=\"$PROJECT_DIR$/dunzomanagement/dunzomanagement/static/main\" />\n      <recent name=\"$PROJECT_DIR$/dunzomanagement/dunzomanagement/templates\" />\n      <recent name=\"$PROJECT_DIR$/dunzomanagement/dunzomanagement/static/css\" />\n      <recent name=\"$PROJECT_DIR$/dunzomanagement/dunzomanagement/static\" />\n    </key>\n  </component>\n  <component name=\"RunManager\" selected=\"Shell Script.Full Stack\">\n    <configuration name=\"Dunzo_ProjectDB\" type=\"Python.DjangoServer\" factoryName=\"Django server\">\n      <module name=\"Dunzo_ProjectDB\" />\n      <option name=\"ENV_FILES\" value=\"\" />\n      <option name=\"INTERPRETER_OPTIONS\" value=\"\" />\n      <option name=\"PARENT_ENVS\" value=\"true\" />\n      <envs>\n        <env name=\"PYTHONUNBUFFERED\" value=\"1\" />\n      </envs>\n      <option name=\"SDK_HOME\" value=\"\" />\n      <option name=\"SDK_NAME\" value=\"Python 3.13\" />\n      <option name=\"WORKING_DIRECTORY\" value=\"$PROJECT_DIR$/backend/dunzomanagement\" />\n      <option name=\"IS_MODULE_SDK\" value=\"false\" />\n      <option name=\"ADD_CONTENT_ROOTS\" value=\"true\" />\n      <option name=\"ADD_SOURCE_ROOTS\" value=\"true\" />\n      <option name=\"launchJavascriptDebuger\" value=\"false\" />\n      <option name=\"port\" value=\"8000\" />\n      <option name=\"host\" value=\"\" />\n      <option name=\"additionalOptions\" value=\"\" />\n      <option name=\"browserUrl\" value=\"\" />\n      <option name=\"runTestServer\" value=\"false\" />\n      <option name=\"runNoReload\" value=\"false\" />\n      <option name=\"useCustomRunCommand\" value=\"false\" />\n      <option name=\"customRunCommand\" value=\"\" />\n      <method v=\"2\" />\n    </configuration>\n    <configuration name=\"Full Stack\" type=\"ShConfigurationType\">\n      <option name=\"SCRIPT_TEXT\" value=\"\" />\n      <option name=\"INDEPENDENT_SCRIPT_PATH\" value=\"true\" />\n      <option name=\"SCRIPT_PATH\" value=\"$PROJECT_DIR$/run_fullstack.sh\" />\n      <option name=\"SCRIPT_OPTIONS\" value=\"\" />\n      <option name=\"INDEPENDENT_SCRIPT_WORKING_DIRECTORY\" value=\"true\" />\n      <option name=\"SCRIPT_WORKING_DIRECTORY\" value=\"$PROJECT_DIR$\" />\n      <option name=\"INDEPENDENT_INTERPRETER_PATH\" value=\"true\" />\n      <option name=\"INTERPRETER_PATH\" value=\"/bin/bash\" />\n      <option name=\"INTERPRETER_OPTIONS\" value=\"\" />\n      <option name=\"EXECUTE_IN_TERMINAL\" value=\"true\" />\n      <option name=\"EXECUTE_SCRIPT_FILE\" value=\"true\" />\n      <envs />\n      <method v=\"2\" />\n    </configuration>\n    <list>\n      <item itemvalue=\"Shell Script.Full Stack\" />\n    </list>\n  </component>\n  <component name=\"SharedIndexes\">\n    <attachedChunks>\n      <set>\n        <option value=\"bundled-python-sdk-8753aad8314d-d902c0275401-com.jetbrains.pycharm.community.sharedIndexes.bundled-PC-252.25557.178\" />\n      </set>\n    </attachedChunks>\n  </component>\n  <component name=\"TaskManager\">\n    <task active=\"true\" id=\"Default\" summary=\"Default task\">\n      <changelist id=\"33aa42ef-630d-454b-aadd-8426bf50f91a\" name=\"Changes\" comment=\"\" />\n      <created>1763652718779</created>\n      <option name=\"number\" value=\"Default\" />\n      <option name=\"presentableId\" value=\"Default\" />\n      <updated>1763652718779</updated>\n      <workItem from=\"1763652722640\" duration=\"212000\" />\n      <workItem from=\"1763652968929\" duration=\"3126000\" />\n      <workItem from=\"1763823527511\" duration=\"1318000\" />\n      <workItem from=\"1763887112293\" duration=\"1315000\" />\n      <workItem from=\"1763992190680\" duration=\"61000\" />\n      <workItem from=\"1764008108331\" duration=\"7864000\" />\n      <workItem from=\"1764057701514\" duration=\"560000\" />\n      <workItem from=\"1764230112166\" duration=\"95878000\" />\n      <workItem from=\"1764588836457\" duration=\"718000\" />\n      <workItem from=\"1764758846613\" duration=\"34000\" />\n      <workItem from=\"1764988719844\" duration=\"3308000\" />\n      <workItem from=\"1765034342109\" duration=\"930000\" />\n      <workItem from=\"1765084283120\" duration=\"833000\" />\n      <workItem from=\"1765116782951\" duration=\"608000\" />\n      <workItem from=\"1765291077958\" duration=\"1500000\" />\n      <workItem from=\"1765299658053\" duration=\"2719000\" />\n      <workItem from=\"1765302528871\" duration=\"1667000\" />\n      <workItem from=\"1765333096447\" duration=\"9396000\" />\n      <workItem from=\"1765345499561\" duration=\"943000\" />\n      <workItem from=\"1765375748733\" duration=\"23039000\" />\n      <workItem from=\"1765447958102\" duration=\"9207000\" />\n      <workItem from=\"1765473405993\" duration=\"4818000\" />\n    </task>\n    <servers />\n  </component>\n  <component name=\"TypeScriptGeneratedFilesManager\">\n    <option name=\"version\" value=\"3\" />\n  </component>\n  <component name=\"UnknownFeatures\">\n    <option featureType=\"dependencySupport\" implementationName=\"javascript:npm:react\" />\n    <option featureType=\"dependencySupport\" implementationName=\"javascript:npm:tailwindcss\" />\n    <option featureType=\"dependencySupport\" implementationName=\"javascript:npm:vite\" />\n    <option featureType=\"dependencySupport\" implementationName=\"executable:podman\" />\n  </component>\n  <component name=\"Vcs.Log.Tabs.Properties\">\n    <option name=\"TAB_STATES\">\n      <map>\n        <entry key=\"MAIN\">\n          <value>\n            <State />\n          </value>\n        </entry>\n      </map>\n    </option>\n  </component>\n  <component name=\"com.intellij.coverage.CoverageDataManagerImpl\">\n    <SUITE FILE_PATH=\"coverage/Dunzo_ProjectDB$views.coverage\" NAME=\"views Coverage Results\" MODIFIED=\"1764279867929\" SOURCE_PROVIDER=\"com.intellij.coverage.DefaultCoverageFileProvider\" RUNNER=\"coverage.py\" COVERAGE_BY_TEST_ENABLED=\"false\" COVERAGE_TRACING_ENABLED=\"false\" WORKING_DIRECTORY=\"$PROJECT_DIR$/dunzomanagement/dunzomanagement\" />\n  </component>\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/workspace.xml b/.idea/workspace.xml
--- a/.idea/workspace.xml	(revision 48f1dab1d466a2bd744f5906b2f163288adeefe0)
+++ b/.idea/workspace.xml	(date 1765899965562)
@@ -5,6 +5,7 @@
   </component>
   <component name="ChangeListManager">
     <list default="true" id="33aa42ef-630d-454b-aadd-8426bf50f91a" name="Changes" comment="">
+      <change beforePath="$PROJECT_DIR$/.idea/copilotDiffState.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/copilotDiffState.xml" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/.idea/workspace.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/workspace.xml" afterDir="false" />
     </list>
     <option name="SHOW_DIALOG" value="false" />
@@ -27,7 +28,7 @@
   <component name="Git.Settings">
     <option name="RECENT_BRANCH_BY_REPOSITORY">
       <map>
-        <entry key="$PROJECT_DIR$" value="auth" />
+        <entry key="$PROJECT_DIR$" value="combined" />
       </map>
     </option>
     <option name="RECENT_GIT_ROOT_PATH" value="$PROJECT_DIR$" />
@@ -38,12 +39,12 @@
     &quot;assignee&quot;: &quot;DMKuZu&quot;
   }
 }</component>
-  <component name="GithubPullRequestsUISettings"><![CDATA[{
-  "selectedUrlAndAccountId": {
-    "url": "https://github.com/Libron-ChristianNeil/Dunzo_ProjectDB.git",
-    "accountId": "87048f45-fda5-4f2e-b05d-cc22aa78e906"
+  <component name="GithubPullRequestsUISettings">{
+  &quot;selectedUrlAndAccountId&quot;: {
+    &quot;url&quot;: &quot;https://github.com/Libron-ChristianNeil/Dunzo_ProjectDB.git&quot;,
+    &quot;accountId&quot;: &quot;e7030cd0-6bfb-4d76-bfe8-972a5abe9d66&quot;
   }
-}]]></component>
+}</component>
   <component name="ProjectColorInfo">{
   &quot;associatedIndex&quot;: 3
 }</component>
@@ -66,7 +67,7 @@
     &quot;SHARE_PROJECT_CONFIGURATION_FILES&quot;: &quot;true&quot;,
     &quot;SHELLCHECK.PATH&quot;: &quot;I do mind&quot;,
     &quot;Shell Script.Full Stack.executor&quot;: &quot;Run&quot;,
-    &quot;git-widget-placeholder&quot;: &quot;FULLSTACK&quot;,
+    &quot;git-widget-placeholder&quot;: &quot;josip&quot;,
     &quot;junie.onboarding.icon.badge.shown&quot;: &quot;true&quot;,
     &quot;last_opened_file_path&quot;: &quot;/home/kuzu/PycharmProjects/Dunzo_ProjectDB/run_fullstack.sh&quot;,
     &quot;node.js.detected.package.eslint&quot;: &quot;true&quot;,
@@ -138,13 +139,15 @@
       <method v="2" />
     </configuration>
     <list>
+      <item itemvalue="Django Server.Dunzo_ProjectDB" />
       <item itemvalue="Shell Script.Full Stack" />
     </list>
   </component>
   <component name="SharedIndexes">
     <attachedChunks>
       <set>
-        <option value="bundled-python-sdk-8753aad8314d-d902c0275401-com.jetbrains.pycharm.community.sharedIndexes.bundled-PC-252.25557.178" />
+        <option value="bundled-js-predefined-d6986cc7102b-9c94529fcfe0-JavaScript-PY-252.26199.168" />
+        <option value="bundled-python-sdk-b3d66beaba9a-c6efb3732140-com.jetbrains.pycharm.pro.sharedIndexes.bundled-PY-252.26199.168" />
       </set>
     </attachedChunks>
   </component>
@@ -177,6 +180,8 @@
       <workItem from="1765375748733" duration="23039000" />
       <workItem from="1765447958102" duration="9207000" />
       <workItem from="1765473405993" duration="4818000" />
+      <workItem from="1765842229255" duration="1847000" />
+      <workItem from="1765878952508" duration="3591000" />
     </task>
     <servers />
   </component>
